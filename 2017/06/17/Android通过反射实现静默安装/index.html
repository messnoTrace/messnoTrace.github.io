<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>your will my hands</title>
  <meta name="author" content="messnoTrace">
  
  <meta name="description" content="本文讲解通过反射Android pm  instal来调用隐藏api， 来静默安装，至于原理什么的，就不多说了，网络上一搜一大把，下面是亲测可行的；先上Demo,其中的libs文件夹下的class.jar是主角。本文有一个大前提，那就是你的apk是放在系统/system/priv-app目录下，也就">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="your will my hands"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="your will my hands" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <header id="header" class='normal_mode'>
    <div class="inner"><div class="alignleft">
  <h1><a href="/"><img class="logo" src="/css/img/logo.png"/>your will my hands</a></h1>
  <h2><a href="/">your will my hands</a></h2>
</div>
<nav id="main-nav">
  <ul>
    
      <li><a href="/">博客</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></div>
  </header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-06-17T01:51:02.353Z">
          <a href="/2017/06/17/Android通过反射实现静默安装/">
              2017-06-17
          </a>
        </time>
      
      
  
    <h1 class="title"></h1>
  

    </header>
    <div class="entry">
      
        <p>本文讲解通过反射Android pm  instal来调用隐藏api， 来静默安装，至于原理什么的，就不多说了，网络上一搜一大把，下面是亲测可行的；<br>先上<a href="https://github.com/messnoTrace/SlienceInstall" target="_blank" rel="external">Demo</a>,其中的libs文件夹下的class.jar是主角。<br>本文有一个大前提，那就是你的apk是放在系统/system/priv-app目录下，也就是说，rom是你们自己搞的，手动滑稽=。=<br>如果你是用AndroidStudio版本的，也是链接中的<a href="https://github.com/messnoTrace/SlienceInstall/tree/master/DemoSilenceInstall" target="_blank" rel="external">DemoSilenceInstall</a><br>步骤如下：</p>
<ul>
<li>建一个你自己的工程 ，将class.jar放入到libs目录下。</li>
<li>然后projectStructure(按F4直接进)，进入dependence点击+号，选择FileDependence 记得把 scope置为Provided，如下图:<br><img src="http://upload-images.jianshu.io/upload_images/1453857-d74f2be33a1b022c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1.png"></li>
</ul>
<ul>
<li><p>工程目录下的gradle文件修改：</p>
<pre><code>allprojects {  
  repositories {      
            jcenter()   
         }  
            gradle.projectsEvaluated {             
                     tasks.withType(JavaCompile) {     
                                   options.compilerArgs.add(&apos;-Xbootclasspath/p:app\\libs\\class.jar&apos;)                  
                  }  
                 }
            }
</code></pre><p>   <strong>看好名字,不要眼瞎，后面是你起的jar包的名字，这个名字随意取，两者对应就行，</strong></p>
<p>  以上的操作的目的有两个：</p>
<pre><code>1.就是将class.jar以eclipse中那种userlib的形式导入，
2.调整jar包的优先级
</code></pre></li>
<li>再将demo中install 包下的代码放到你的工程中.如果这个时候你的PM.java这个文件不报错，那么恭喜，你的操作就算完成了</li>
<li>这个步骤我的代码出现了问题，不知道你的会不会，就是Android中65535问题了，也就是解决这个问题做的操作，AS下好解决，这个不做过多解释。</li>
</ul>
<p>剩下的，就是将应用打包签名，放到/system/priv-app这个目录下 就ok了，</p>
<p>下面说下Eclipse版本的操作，代码都是一样的，jar包也是一样，就两点，jar包通过userlibrary的形式导入，直接放图吧，多图慎入：<br><img src="http://upload-images.jianshu.io/upload_images/1453857-e9e8d436fbd4ddde.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="
![Uploading 4_049957.png . . .]
"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-d5b134f0db69b9a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="3.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-cecd54290fd90360.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="4.png"></p>
<p>![</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-e6cde6675deb959b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Uploading 6_086779.png . . .]
"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-16490fdfd7ab0de6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="6.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-73ac54c47095b33b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="7.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-c524e6d1cb374503.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="8.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-c57017127dc439c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="9.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-d0b9e66477c90d60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="
![Uploading 10_162291.png . . .]
"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1453857-8fd7af66b59e3784.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="11.png"></p>
<p>至此，，搞定了，╮(╯▽╰)╭，继续搬砖。如果你要问这个class怎么来的，你找做rom的大神们给你编译一份源码就行，反正我不会。OTZ…. 然而这个地方在我写完文章后又出现了一个实战问题，那就是用multydex分包处理后，还是会出现 <a href="http://stackoverflow.com/questions/32721083/too-many-classes-in-main-dex-list-main-dex-capacity-exceeded" target="_blank" rel="external">Too many classes in –main-dex-list, main dex capacity exceeded</a>，，目前一个最简单暴力的方法就是把minsdkversion 调成21+，我在想想办法，，，，解决了更新文章。</p>
<p>(⊙o⊙)…，暂时没解决，不过上了一个新版本，用aidl实现的，也是可以用<a href="https://github.com/messnoTrace/SlienceInstall/tree/master/MyApplication" target="_blank" rel="external">这里的</a>…东西都差不多，jar包换了个精简的，然后改用aidl实现的注意，aidl的包名不要动，，，然后配置下gradle里面的aidl</p>

      
    </div>
    <footer>
      
        
        
        
  <div class="addthis addthis_toolbox addthis_default_style">
    
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <!-- JiaThis Button BEGIN -->
    <div class="jiathis_style">
        <span class="jiathis_txt">分享到：</span>
        <a class="jiathis_button_icons_1"></a>
        <a class="jiathis_button_icons_2"></a>
        <a class="jiathis_button_icons_3"></a>
        <a class="jiathis_button_icons_4"></a>
        <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
        <a class="jiathis_counter_style"></a>
    </div>
    <script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js" charset="utf-8"></script>
    <!-- JiaThis Button END -->

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
    var duoshuoQuery = {short_name:"moo123"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
<!-- Duoshuo Comment END -->
  
</section>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:messnoTrace.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2017/06/17/Android Accessibility 的简单用法/"></a>
      </li>
    
      <li>
        <a href="/2017/06/17/AndroidStudio中调用.so包出现找不到.so包的错误/"></a>
      </li>
    
      <li>
        <a href="/2017/06/17/如何修改CheckBoxPreference 中title ，summary字体的颜色/"></a>
      </li>
    
      <li>
        <a href="/2017/06/17/Android 多渠道打包如何修改app name，icon/"></a>
      </li>
    
      <li>
        <a href="/2017/06/17/Android通过反射实现静默安装/"></a>
      </li>
    
  </ul>
</div>


  

  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 messnoTrace
  
  
    <a class="icon github" href="https://github.com/yunlzheng">github</a>
    <a href="http://weibo.com/503error">weibo</a>
    <a href="http://www.google.com">google+</a>
  
</div>

<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




    <script type="text/javascript">
        (function(){

            $(window).scroll(function(){

                var scrollTop = $(window).scrollTop();
                if ( scrollTop >200 ){
                    $("#header").removeClass('normal_mode').addClass('top_mode');
                } else{
                    $("#header").removeClass('top_mode').addClass('normal_mode');
                }

            });

        })();
    </script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>