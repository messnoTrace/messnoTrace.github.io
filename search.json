[{"title":"Android å¤šæ¸ é“æ‰“åŒ…ä¿®æ”¹app nameï¼Œicon","url":"/2019/04/05/Android-å¤šæ¸ é“æ‰“åŒ…ä¿®æ”¹app-nameï¼Œicon/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \næè¿‡å¤šæ¸ é“æ‰“åŒ…çš„éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ module çš„build.gradleä¸­é…ç½®ç›¸åº”çš„æ¸ é“å·å°±è¡Œ:\n\n                   \n                    productFlavor{\n                              baidu {\n                              }\n                            xiaomi{}\n                             wandoujia{}\n                        }\nåƒè¿™æ ·ï¼Œå°±å¯ä»¥äº†ï¼Œç„¶åå°†å‹ç›Ÿçš„chanelvalueä¿®æ”¹ä¸‹å°±å¯ä»¥äº†ï¼Œéœ€è¦ä¸åŒçš„æ¸ é“ï¼Œé…ç½®ä¸åŒçš„applicationidï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚ä¸è¿‡ä»Šå¤©æˆ‘é‡åˆ°çš„éœ€æ±‚æ˜¯ï¼Œä¸åŒçš„æ¸ é“é…ç½®ä¸åŒçš„appnameå’Œiconã€‚ä¸€å¼€å§‹æˆ‘æƒ³ç€ç”¨ä¹‹å‰çš„å“ªç§æ–¹æ³•åº”è¯¥å¯è¡Œï¼Œç„¶åå°±è¯•äº†ä¸‹ï¼Œä¸€è¯•ä¸çŸ¥é“ï¼Œè¯•è¿‡å°±è›‹ç–¼äº†ï¼Œappnameæ˜¯å¯ä»¥æ¢æ‰ï¼Œä½†æ˜¯iconå‘¢ï¼Œï¼Œå’‹æ•´ï¼Œï¼Œï¼Œæ‰¾äº†ä¸€åœˆæ–¹æ³•ï¼Œéƒ½æœ¨æœ‰æ‰¾åˆ°ï¼Œéƒé—·ï¼Œstringç±»å‹çš„ï¼Œéƒ½å¯ä»¥é€šè¿‡å¸¸ç”¨çš„é‚£ç§æ›¿æ¢å ä½ç¬¦çš„æ–¹å¼æ¥æ”¹ï¼Œæˆ–è€…æ˜¯resValue(è¿™ä¸ªæ²¡æœ‰è¯•ï¼Œï¼Œä½†æ˜¯ä¼¼ä¹æ˜¯å¯ä»¥çš„)ã€‚ç„¶åå„ç§æœèµ„æ–™ï¼Œæœ‰ä»€ä¹ˆè®¾ç½® useOldManifestMerger false ï¼Œä¸è¿‡è‡ªå·±æ²¡è¯•æˆåŠŸï¼ˆä¸èƒ½æ€ªæˆ‘ï¼Œç†è®ºæ˜¯è¿™ä¸ªé“ç†çš„ï¼Œåªä¸è¿‡gradleç‰ˆæœ¬ä¸ä¸€æ ·ï¼ŒGoogleå‡çº§äº†ï¼Œå¯¼è‡´æˆ‘æ‡µé€¼äº†ï¼‰å¶ç„¶é—´Googleäº†ä¸€ä¸‹  how to change app icon for diffrent productFlavors in androidï¼Œç‚¹å¼€ç¬¬ä¸€ä¸ª[é“¾æ¥](http://stackoverflow.com/questions/22875948/how-to-provide-different-android-app-icons-for-different-gradle-buildtypes),ç„¶åç­”ä¸»çš„ç­”æ¡ˆç»™äº†æˆ‘ä¸€äº›å¯å‘ï¼š\n\n\n![QQæˆªå›¾20160811184619.png](http://upload-images.jianshu.io/upload_images/1453857-3cbf6c005c8c592c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\nç„¶åæœå•Šæœï¼Œåˆæ‰¾åˆ°äº†[è¿™ä¸ª](http://stackoverflow.com/questions/25981156/tools-replace-not-replacing-in-android-manifest)\n\n\n\n\n![QQæˆªå›¾20160811185123.png](http://upload-images.jianshu.io/upload_images/1453857-0c8656280ca0a302.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\nç„¶åç»è¿‡è‡ªå·±çš„æ‘¸ç´¢ï¼Œæäº†å‡ºæ¥äº†ï¼Œç®€å•æ¥è¯´ï¼š\nå¤§å®¶çœ‹ç¬¬ä¸€å¼ å›¾ä½ çš„ç›®å½•ç»“æ„å°±ä¼šå‘ç°ï¼Œå¦‚æœæˆ‘ä»¬åœ¨src/main/æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä»¥æˆ‘ä»¬å»æ¸ é“åä¸ºåçš„ï¼Œç›®å½•ç»“æ„å’Œmainä¸€æ ·çš„æ–‡ä»¶ç›®å½•ï¼Œå½“æˆ‘ä»¬æ‰“åŒ…çš„æ—¶å€™å°±ä¼šè¯»å–è¿™é‡Œé¢çš„èµ„æºæ–‡ä»¶ï¼Œæ‰€ä»¥å‘¢ï¼Œæˆ‘å°±æ–°å»ºäº†ä¸ªæ¸…å•æ–‡ä»¶ï¼Œå°†å¤´éƒ¨æ¢æˆå›¾äºŒæ‰€ç¤ºï¼Œåœ¨æ ¹ç›®å½•æ·»åŠ \n\n                  xmlns:tools=\"http://schemas.android.com/tools\"\n\nç„¶åapplication\n  \n          tools:replace=\"android:icon\" \n          android:icon=\"@drawable/icon_all\"\n\næ›¿æ¢ä½ éœ€è¦æ¢çš„iconå°±è¡Œï¼Œokï¼Œè‡³æ­¤æå®šï¼Œè‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆæï¼Œæˆ‘çœ‹åˆ°äº†å®˜æ–¹çš„ä¸€ç¯‡æ–‡ç« [æ¸…å•åˆå¹¶](http://tools.android.com/tech-docs/new-build-system/user-guide/manifest-merger#TOC-Manifest-files-ordering),å¦å¤–è¿˜æœ‰ç¯‡å›½å†…[è¯‘æ–‡](http://blog.csdn.net/maosidiaoxian/article/details/42671999)\n\n\nå‰©ä¸‹çš„å°±é å°ä¼™ä¼´ä¹ˆè‡ªå·±æ‘¸ç´¢äº†ã€‚ã€‚ã€‚ã€‚"},{"title":"AndroidStudioä¸­è°ƒç”¨.soåŒ…å‡ºç°æ‰¾ä¸åˆ°.soåŒ…çš„é”™è¯¯","url":"/2019/04/05/AndroidStudioä¸­è°ƒç”¨-soåŒ…å‡ºç°æ‰¾ä¸åˆ°-soåŒ…çš„é”™è¯¯/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \n\n![QQæˆªå›¾20160721125018.png](http://upload-images.jianshu.io/upload_images/1453857-0fb31dfbb366a918.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n###å‡ºç°åŸå› \nRT,åœ¨Andoridsutdioä¸­è°ƒç”¨.soåº“å‡ºç°å¦‚ç°æ ‡é¢˜æ‰€ç¤ºé”™è¯¯ï¼Œè¯¥æ€ä¹ˆè§£å†³ã€‚é¦–å…ˆå‡ºç°è¿™ä¸ªé”™è¯¯çš„åŸå› æ˜¯å› ä¸ºä½ çš„cpuæ¶æ„æ˜¯64ä½çš„ã€‚è€Œä½ çš„.soåº“åœ¨ç¼–è¯‘çš„æ—¶å€™æ²¡æœ‰æ”¯æŒ64ä½cpuã€‚**  å¦‚æœè¿™ä¸ª.soçš„åº“æ˜¯ä½ è‡ªå·±å¼„çš„ï¼Œé‚£ä½ é‡æ–°ç”Ÿæˆä¸‹æ”¯æŒ64ä½cpuçš„.soåº“å‡ºæ¥å°±è¡Œäº†ï¼Œå‰©ä¸‹çš„æ–‡å­—å°±ä¸ç”¨çœ‹äº†ï¼Œæœ¬æ–‡é€‚ç”¨äºä½ æ²¡æ³•å¯¹.soåšæ“ä½œçš„æœ‹å‹ã€‚** æŸ¥çœ‹cpuæ¶æ„ï¼Œå¯ä»¥é€šè¿‡adb shell å‘½ä»¤ã€‚è¿›å…¥/system/ç›®å½•ä¸‹æœ‰ä¸€ä¸ªbuild.propæ–‡ä»¶ï¼Œè¿™ä¸ªé‡Œé¢æœ‰ä¸€è¡Œ ro.product.cpu.abi=xxå°±æ˜¯ä½ æ‰€è¦çš„ä¿¡æ¯ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹:\n\n                    adb shell\n                    cd /system\n                    cat build.prop\n\n\napkåŒ…åœ¨å®‰è£…çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šæŠŠåŒ…ä¸­ä¸è‡ªå·±çš„abiå¯¹åº”çš„libç›®å½•ä¸­çš„soåº“æ–‡ä»¶æ‹·è´åˆ°systemåˆ†åŒºä¸­ï¼Œ32ä½æœºå™¨ä¸­åªæœ‰ä¸€ä¸ªç›®å½•/system/libï¼Œ64ä½æœºå™¨ä¸­æœ‰ä¸¤ä¸ªç›®å½•/system/libå’Œ/system/lib64ï¼Œappå¯åŠ¨è¿›è¡Œé“¾æ¥æ—¶ï¼Œ64ä½æœºå™¨ä¸­ä¼šå…ˆåˆ°/system/lib64ç›®å½•ä¸­å»æ‰¾ï¼Œè¿™æ—¶å€™è‚¯å®šæ‰¾ä¸åˆ°ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å†åˆ°/system/libç›®å½•ä¸­å»æ‰¾ã€‚å¦‚æœä½ æŠŠ32ä½çš„soåº“æ‹·è´åˆ°äº†lib64ç›®å½•ä¸­ï¼Œä¼šå¯¼è‡´é“¾æ¥å¤±è´¥ï¼ŒåŒæ ·ï¼Œ64ä½çš„soåº“è¢«æ‹·è´åˆ°libç›®å½•ä¸­ä¹Ÿä¼šå¯¼è‡´å¤±è´¥ï¼Œæ‰€ä»¥soåº“è¦å’Œç›®å½•ä¸€ä¸€å¯¹åº”ã€‚\n\n###è§£å†³æ–¹æ¡ˆ\né¦–å…ˆæˆ‘çš„ç›®å½•ç»“æ„æ˜¯è¿™æ ·çš„ï¼š\n![QQæˆªå›¾20160721123538.png](http://upload-images.jianshu.io/upload_images/1453857-be5473a00f8f04a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\næˆ‘çš„.soå¹¶æ²¡æœ‰æ”¾åœ¨æ–°å»ºçš„jniLibsç›®å½•ä¸­ï¼Œè¿™ä¸ªå…³ç³»åº”è¯¥ä¸å¤§ï¼Œä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ã€‚\næˆ‘çš„cpuæ¶æ„æ˜¯ ro.product.cpu.abi=arm64-v8a\nè€Œæˆ‘çš„åªæœ‰ä¸€ä¸ªCPUæ¶æ„å°±æ˜¯armebi-v7a,æˆ‘ä»¬è¦åšçš„å°±æ˜¯é˜»æ­¢ç”Ÿæˆarm64-v8a;\næ­£å¸¸æƒ…å†µæ‰“å¼€apkçš„libç»“æ„å¦‚ä¸‹ï¼š\n![QQæˆªå›¾20160721124748.png](http://upload-images.jianshu.io/upload_images/1453857-5e5183dd73f1ac09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næ–¹æ¡ˆå¦‚ä¸‹ï¼š\n* é¦–å…ˆåœ¨projectç›®å½•ä¸‹çš„ gradle.propertiesä¸­æ·»åŠ ä¸€å¥ \n              android.useDeprecatedNdk=true\n* åœ¨appçš„build.gradleä¸­çš„defaulConfigä¸‹æ·»åŠ å¦‚ä¸‹ï¼š\n            ndk {  \n              abiFilters \"armeabi\", \"armeabi-v7a\", \"x86\", \"mips\"\n            }\n\n\nè¿™æ—¶å€™ä½ è§£å‹å¼€ç”Ÿæˆçš„apkåŒ…ï¼Œä¼šå‘ç°ç›®å½•libç»“æ„å¦‚ä¸‹ï¼š\n\n![QQæˆªå›¾20160721124539.png](http://upload-images.jianshu.io/upload_images/1453857-df30fc0704288587.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nOKï¼Œè¿™æ ·å°±è§£å†³äº†æˆ‘çš„è¿™ä¸ªé—®é¢˜ï¼Œç½‘ç»œä¸Šæœ‰ä¸€äº›åˆ«çš„é˜»æ­¢ç”Ÿæˆarm64-v8aï¼Œä½†æ˜¯ä¸å¥½ä½¿ã€‚"},{"title":"Androidé€šè¿‡åå°„å®ç°é™é»˜å®‰è£…","url":"/2019/04/05/Androidé€šè¿‡åå°„å®ç°é™é»˜å®‰è£…/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \n\næœ¬æ–‡è®²è§£é€šè¿‡åå°„Android pm  instalæ¥è°ƒç”¨éšè—apiï¼Œ æ¥é™é»˜å®‰è£…ï¼Œè‡³äºåŸç†ä»€ä¹ˆçš„ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç½‘ç»œä¸Šä¸€æœä¸€å¤§æŠŠï¼Œä¸‹é¢æ˜¯äº²æµ‹å¯è¡Œçš„ï¼›\nå…ˆä¸Š[Demo](https://github.com/messnoTrace/SlienceInstall),å…¶ä¸­çš„libsæ–‡ä»¶å¤¹ä¸‹çš„class.jaræ˜¯ä¸»è§’ã€‚\næœ¬æ–‡æœ‰ä¸€ä¸ªå¤§å‰æï¼Œé‚£å°±æ˜¯ä½ çš„apkæ˜¯æ”¾åœ¨ç³»ç»Ÿ/system/priv-appç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œromæ˜¯ä½ ä»¬è‡ªå·±æçš„ï¼Œæ‰‹åŠ¨æ»‘ç¨½=ã€‚= \nå¦‚æœä½ æ˜¯ç”¨AndroidStudioç‰ˆæœ¬çš„ï¼Œä¹Ÿæ˜¯é“¾æ¥ä¸­çš„[DemoSilenceInstall](https://github.com/messnoTrace/SlienceInstall/tree/master/DemoSilenceInstall)\næ­¥éª¤å¦‚ä¸‹ï¼š\n * å»ºä¸€ä¸ªä½ è‡ªå·±çš„å·¥ç¨‹ ï¼Œå°†class.jaræ”¾å…¥åˆ°libsç›®å½•ä¸‹ã€‚\n * ç„¶åprojectStructure(æŒ‰F4ç›´æ¥è¿›)ï¼Œè¿›å…¥dependenceç‚¹å‡»+å·ï¼Œé€‰æ‹©FileDependence è®°å¾—æŠŠÂ scopeç½®ä¸ºProvidedï¼Œå¦‚ä¸‹å›¾:\n![1.png](http://upload-images.jianshu.io/upload_images/1453857-d74f2be33a1b022c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n* å·¥ç¨‹ç›®å½•ä¸‹çš„gradleæ–‡ä»¶ä¿®æ”¹ï¼š\n              allprojects {  \n                repositories {      \n                          jcenter()   \n                       }  \n                          gradle.projectsEvaluated {             \n                                   tasks.withType(JavaCompile) {     \n                                                 options.compilerArgs.add('-Xbootclasspath/p:app\\\\libs\\\\class.jar')                  \n                                }  \n                               }\n                          }\n\n     **çœ‹å¥½åå­—,ä¸è¦çœ¼çï¼Œåé¢æ˜¯ä½ èµ·çš„jaråŒ…çš„åå­—ï¼Œè¿™ä¸ªåå­—éšæ„å–ï¼Œä¸¤è€…å¯¹åº”å°±è¡Œï¼Œ**\n\n    ä»¥ä¸Šçš„æ“ä½œçš„ç›®çš„æœ‰ä¸¤ä¸ªï¼š\n      1.å°±æ˜¯å°†class.jarä»¥eclipseä¸­é‚£ç§userlibçš„å½¢å¼å¯¼å…¥ï¼Œ\n      2.è°ƒæ•´jaråŒ…çš„ä¼˜å…ˆçº§\n* å†å°†demoä¸­install åŒ…ä¸‹çš„ä»£ç æ”¾åˆ°ä½ çš„å·¥ç¨‹ä¸­.å¦‚æœè¿™ä¸ªæ—¶å€™ä½ çš„PM.javaè¿™ä¸ªæ–‡ä»¶ä¸æŠ¥é”™ï¼Œé‚£ä¹ˆæ­å–œï¼Œä½ çš„æ“ä½œå°±ç®—å®Œæˆäº†\n* è¿™ä¸ªæ­¥éª¤æˆ‘çš„ä»£ç å‡ºç°äº†é—®é¢˜ï¼Œä¸çŸ¥é“ä½ çš„ä¼šä¸ä¼šï¼Œå°±æ˜¯Androidä¸­65535é—®é¢˜äº†ï¼Œä¹Ÿå°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜åšçš„æ“ä½œï¼ŒASä¸‹å¥½è§£å†³ï¼Œè¿™ä¸ªä¸åšè¿‡å¤šè§£é‡Šã€‚\n\n\nå‰©ä¸‹çš„ï¼Œå°±æ˜¯å°†åº”ç”¨æ‰“åŒ…ç­¾åï¼Œæ”¾åˆ°/system/priv-appè¿™ä¸ªç›®å½•ä¸‹ å°±okäº†ï¼Œ\n\nä¸‹é¢è¯´ä¸‹Eclipseç‰ˆæœ¬çš„æ“ä½œï¼Œä»£ç éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒjaråŒ…ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå°±ä¸¤ç‚¹ï¼ŒjaråŒ…é€šè¿‡userlibraryçš„å½¢å¼å¯¼å…¥ï¼Œç›´æ¥æ”¾å›¾å§ï¼Œå¤šå›¾æ…å…¥ï¼š\n![\n![Uploading 4_049957.png . . .]\n](http://upload-images.jianshu.io/upload_images/1453857-e9e8d436fbd4ddde.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![3.png](http://upload-images.jianshu.io/upload_images/1453857-d5b134f0db69b9a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![4.png](http://upload-images.jianshu.io/upload_images/1453857-cecd54290fd90360.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n![\n\n![Uploading 6_086779.png . . .]\n](http://upload-images.jianshu.io/upload_images/1453857-e6cde6675deb959b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n![6.png](http://upload-images.jianshu.io/upload_images/1453857-16490fdfd7ab0de6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n\n\n\n\n![7.png](http://upload-images.jianshu.io/upload_images/1453857-73ac54c47095b33b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n\n![8.png](http://upload-images.jianshu.io/upload_images/1453857-c524e6d1cb374503.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n![9.png](http://upload-images.jianshu.io/upload_images/1453857-c57017127dc439c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n\n![\n![Uploading 10_162291.png . . .]\n](http://upload-images.jianshu.io/upload_images/1453857-d0b9e66477c90d60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n![11.png](http://upload-images.jianshu.io/upload_images/1453857-8fd7af66b59e3784.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nè‡³æ­¤ï¼Œï¼Œæå®šäº†ï¼Œâ•®(â•¯â–½â•°)â•­ï¼Œç»§ç»­æ¬ç –ã€‚å¦‚æœä½ è¦é—®è¿™ä¸ªclassæ€ä¹ˆæ¥çš„ï¼Œä½ æ‰¾åšromçš„å¤§ç¥ä»¬ç»™ä½ ç¼–è¯‘ä¸€ä»½æºç å°±è¡Œï¼Œåæ­£æˆ‘ä¸ä¼šã€‚OTZ.... ç„¶è€Œè¿™ä¸ªåœ°æ–¹åœ¨æˆ‘å†™å®Œæ–‡ç« ååˆå‡ºç°äº†ä¸€ä¸ªå®æˆ˜é—®é¢˜ï¼Œé‚£å°±æ˜¯ç”¨multydexåˆ†åŒ…å¤„ç†åï¼Œè¿˜æ˜¯ä¼šå‡ºç° [Too many classes in --main-dex-list, main dex capacity exceeded](http://stackoverflow.com/questions/32721083/too-many-classes-in-main-dex-list-main-dex-capacity-exceeded)ï¼Œï¼Œç›®å‰ä¸€ä¸ªæœ€ç®€å•æš´åŠ›çš„æ–¹æ³•å°±æ˜¯æŠŠminsdkversion è°ƒæˆ21+ï¼Œæˆ‘åœ¨æƒ³æƒ³åŠæ³•ï¼Œï¼Œï¼Œï¼Œè§£å†³äº†æ›´æ–°æ–‡ç« ã€‚\n\n\n(âŠ™oâŠ™)â€¦ï¼Œæš‚æ—¶æ²¡è§£å†³ï¼Œä¸è¿‡ä¸Šäº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œç”¨aidlå®ç°çš„ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”¨[è¿™é‡Œçš„](https://github.com/messnoTrace/SlienceInstall/tree/master/MyApplication)...ä¸œè¥¿éƒ½å·®ä¸å¤šï¼ŒjaråŒ…æ¢äº†ä¸ªç²¾ç®€çš„ï¼Œç„¶åæ”¹ç”¨aidlå®ç°çš„æ³¨æ„ï¼Œaidlçš„åŒ…åä¸è¦åŠ¨ï¼Œï¼Œï¼Œç„¶åé…ç½®ä¸‹gradleé‡Œé¢çš„aidl\n"},{"title":"Androidä¿®æ”¹CheckBoxPreference ä¸­title ï¼Œsummaryå­—ä½“çš„é¢œè‰²","url":"/2019/04/05/Androidä¿®æ”¹CheckBoxPreference-ä¸­title-ï¼Œsummaryå­—ä½“çš„é¢œè‰²/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \n\nä»¥å‰æ²¡æ€ä¹ˆå…³æ³¨è¿‡PreferenceActivityçš„ä¸€äº›ç”¨æ³•åªæ˜¯ç®€å•äº†è§£ä¸‹ï¼Œç„¶ååˆšå¥½ä»Šå¤©é‡åˆ°äº†æŸä¸ªæœºå‹ä¸Šå‡ºç°äº†é—®é¢˜ï¼š**æˆ‘æ˜æ˜è®¾ç½®çš„æ˜¯é»‘è‰²çš„å­—ä½“ï¼Œåœ¨è¿™ä¸ªæœºå™¨ä¸Šå´æ˜¯ç™½è‰²çš„**ï¼Œç„¶åå„ç§æ‘¸ç´¢å¾—å‡ºäº†ä¸ªæ¨è®ºï¼Œé¡µé¢çš„å­—ä½“é¢œè‰²ä»€ä¹ˆçš„ï¼Œå¯èƒ½æ˜¯æ›´éšç³»ç»Ÿæ¥çš„ï¼Œå—ç³»ç»Ÿè°ƒæ§ï¼š\næˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼Œ\n\n                <CheckBoxPreference    \n                android:defaultValue=\"true\"   \n               android:key=\"weather_use_metric\"  \n              android:textColor=\"@color/black\"\n                android:title=\"@string/weather_use_metric\" />\n\né—®é¢˜å‡ºç° äº†é‚£æ²¡åŠæ³•ï¼Œåªèƒ½æƒ³åŠæ³•æ”¹äº†ï¼Œå¥½åœ¨ç°åœ¨å­¦ä¼šäº†é¢å‘googleç¼–ç¨‹ï¼Œç„¶åæœçš„ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå…ˆä¸Šæ€ä¹ˆè§£å†³ï¼Œç„¶åå†è¯´ä¸ºä»€ä¹ˆè¿™ä¹ˆå¹²ã€‚é¦–å…ˆå»ºä¸ªlayout ï¼Œåå­—éšä¾¿å–ï¼ˆæˆ‘å–åcustom_preferece_layout.xmlï¼‰ï¼Œå†…å®¹å¦‚ä¸‹:\n\n              <LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" \n                 android:layout_width=\"match_parent\"\n               android:layout_height=\"wrap_content\"   \n               android:minHeight=\"?android:attr/listPreferredItemHeight\" \n               android:gravity=\"center_vertical\" \n               android:paddingRight=\"?android:attr/scrollbarSize\">  \n            <RelativeLayout android:layout_width=\"wrap_content\"        \n              android:layout_height=\"wrap_content\" android:layout_marginLeft=\"15dip\"   \n             android:layout_marginRight=\"6dip\"\n             android:layout_marginTop=\"6dip\"      \n             android:layout_marginBottom=\"6dip\" \n             android:layout_weight=\"1\">     \n            <TextView android:id=\"@+android:id/title\"       \n               android:layout_width=\"wrap_content\" \n             android:layout_height=\"wrap_content\"         \n             android:singleLine=\"true\" \n              android:textAppearance=\"?android:attr/textAppearanceLarge\"        \n              android:ellipsize=\"marquee\" android:fadingEdge=\"horizontal\"         \n             android:textColor=\"@color/black\" />    \n            <TextView android:id=\"@+android:id/summary\"     \n             android:layout_width=\"wrap_content\" \n            android:layout_height=\"wrap_content\"          \n            android:layout_below=\"@android:id/title\" \n            android:layout_alignLeft=\"@android:id/title\"           \n           android:textAppearance=\"?android:attr/textAppearanceSmall\"        \n           android:maxLines=\"4\" />   \n       </RelativeLayout>    \n    <!-- Preference should place its actual preference widget here. -->  \n        <LinearLayout android:id=\"@+android:id/widget_frame\"     \n           android:layout_width=\"wrap_content\"\n           android:layout_height=\"match_parent\"        \n          android:gravity=\"center_vertical\" android:orientation=\"vertical\" />\n      </LinearLayout>\n\nåœ¨è¿™ä¸ªå¸ƒå±€ä¸­ä¿®æ”¹titleï¼Œsunmmaryçš„é¢œè‰²å°±å¯ä»¥äº†ã€‚\nç„¶åå†CheckBoxPreference    ä¸­åŠ ä¸€å¥ï¼š\n\n\n          <CheckBoxPreference   \n           android:defaultValue=\"true\"   \n             android:key=\"weather_use_metric\"  \n            android:layout=\"@layout/custom_preferece_layout\" \n            android:textColor=\"@color/black\"   \n               />\nç„¶åï¼Œå°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¸ºä»€ä¹ˆè¿™ä¹ˆæå‘¢ï¼Ÿè¿›å…¥CheckBoxPreference   é¡¶å±‚çˆ¶ç±»Preferenceä¸­çœ‹ï¼Œçœ‹åˆ°æ„é€ ä¸­çš„æ³¨é‡Šäº†ï¼š\n\n\n![QQæˆªå›¾20161110175559.png](http://upload-images.jianshu.io/upload_images/1453857-fca483c577435efc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\nè¿™ç©æ„é»˜è®¤çš„æ§åˆ¶äº†æ ·å¼ï¼Œç„¶åå†å¾€ä¸‹çœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ï¼š\n\n\n![QQæˆªå›¾20161110175911.png](http://upload-images.jianshu.io/upload_images/1453857-54f7fd8444a953dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nä»–è¯´å¤§éƒ¨åˆ†æƒ…å†µè¶³å¤Ÿç”¨äº†ï¼Œä½†æ˜¯è¿™ä¸æ˜¯å‡ºæ¥é—®é¢˜ä¹ˆï¼Œäºæ˜¯åˆ°androidçš„valuesä¸­çš„atträ¸‹æ‰¾ï¼Œ\n\n\n![Paste_Image.png](http://upload-images.jianshu.io/upload_images/1453857-e5a69f67b3b10c3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nå—¯å¾ˆè´´å¿ƒï¼Œè¡Œæ•°éƒ½æˆªå‡ºæ¥äº†ã€‚é¡¶å±‚é»˜è®¤å®ç°äº†ä¸ªå¸ƒå±€ï¼Œåœ¨CheckBoxPreferenceçš„onBindViewæ–¹æ³•ä¸­å‡ºç°äº†ä¸ªidå’Œä¸€ä¸ªæ–¹æ³•ï¼š\n![QQæˆªå›¾20161110181103.png](http://upload-images.jianshu.io/upload_images/1453857-30381fbc2e2d3ff8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nidç‚¹è¿›å»èƒ½æ‰¾åˆ°ä¸ªå¸ƒå±€ï¼Œç„¶åå†çˆ¶ç±»TwoStatePreferenceä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•é‡Œé¢å†™äº†ä»€ä¹ˆï¼Œæ³¨æ„çœ‹ä¸Šé¢çš„å¸ƒå±€æ§ä»¶çš„idï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯è¦†ç›–äº†preference_material.xml ä¸­çš„å¸ƒå±€ï¼š\n\n\n![QQæˆªå›¾20161110181315.png](http://upload-images.jianshu.io/upload_images/1453857-c2fb7896c6189aba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\né™„ä¸Šç­”æ¡ˆé“¾æ¥ [http://stackoverflow.com/questions/4469514/how-to-customize-text-color-of-the-checkboxpreference-title](http://stackoverflow.com/questions/4469514/how-to-customize-text-color-of-the-checkboxpreference-title)\n"},{"title":"Android Accessbilityçš„ç®€å•ç”¨æ³•","url":"/2019/04/05/Android-Accessbilityçš„ç®€å•ç”¨æ³•/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \nAccessbility åˆå«åšè¾…åŠ©åŠŸèƒ½ï¼Œæ˜¯Androidå®˜æ–¹æ¨å‡ºå¸®åŠ©èº«ä½“ä¸ä¾¿æˆ–è€…æ“ä½œä¸çµæ´»çš„äººæ¥è¾…åŠ©æ“ä½œçš„ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å¹²ä¸€äº›åˆ«çš„äº‹ï¼Œæ¯”å¦‚è‡ªåŠ¨æŠ¢çº¢åŒ…å•Šï¼Œé™é»˜å®‰è£…ç‚¹å‡»å•Šç­‰å·²çŸ¥æˆ–è€…æœªçŸ¥çš„åº”ç”¨ã€‚å‡ºäºæŸç§éœ€æ±‚ï¼Œå°±ç ”ç©¶äº†ä¸‹è¿™ä¸ªåŠŸèƒ½çš„ç®€å•ç”¨æ³•ï¼Œå…ˆåšä¸€ä¸ªæ¨¡æ‹ŸæŒ‰é’®ç‚¹å‡»çš„æ•ˆæœã€‚\n  å¸ƒå±€å¾ˆç®€å•ï¼Œå°±ä¸è´´ä»£ç äº†ï¼Œç®€å•æè¿°ä¸‹ï¼Œä¸»ç•Œé¢å°±ä¸€ä¸ªæŒ‰é’®ï¼Œidéšä¾¿ä½ å–ï¼Œåœ¨Activityä¸­è®¾ç½®ç‚¹å‡»äº‹ä»¶ï¼Œå¼¹å‡ºä¸€ä¸ªToastã€‚\n\n#####æ­¥éª¤\n1. åˆ›å»ºCheckAccessbilityServicesï¼š\n CheckAccessbilityServices ç»§æ‰¿è‡ªAccessibilityServiceï¼Œå¹¶åœ¨æ¸…å•æ–‡ä»¶applcationèŠ‚ç‚¹ä¸­é…ç½®ï¼Œå¹¶åŠ å…¥æƒé™\n    \n          <service   \n           android:name=\".CheckAccessbilityServices\"   \n           android:enabled=\"true\"        \n          android:exported=\"true\"\n          android:label=\"æµ‹è¯•ç‚¹å‡»\"\n          android:permission=\"android.permission.BIND_ACCESSIBILITY_SERVICE\">  \n              <intent-filter>      \n                <action android:name=\"android.accessibilityservice.AccessibilityService\" />\n                </intent-filter> \n             <meta-data\n                   android:name=\"android.accessibilityservice\"\n                   android:resource=\"@xml/check_accessibility_config\" />\n          </service>'\n2.åœ¨resç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹xmlï¼Œå¹¶åˆ›å»ºæ­¥éª¤ä¸€ä¸­check_accessibility_config.xml\n\n            <accessibility-service xmlns:android=\"http://schemas.android.com/apk/res/android\"                   android:description=\"@string/check_click\" \n                android:packageNames=\"com.notrace\"      \n            android:accessibilityEventTypes=    \"typeAllMask|typeViewClicked|typeViewFocused|typeNotificationStateChanged|typeWindowStateChanged\"    \n              android:accessibilityFlags=\"flagDefault\"   \n              android:accessibilityFeedbackType=\"feedbackSpoken\"    \n              android:notificationTimeout=\"100\"   \n              android:canRetrieveWindowContent=\"true\"    />\nè¿™é‡Œé¢æœ‰ä¸€äº›å¸¸ç”¨çš„å±æ€§ï¼Œç®€å•ä»‹ç»ä¸‹\n          android:accessibilityEventTypes=\"typeAllMask\"\nçœ‹å±æ€§åä¹Ÿå·®ä¸å¤šå¯ä»¥æ˜ç™½ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥è®¾ç½®å“åº”äº‹ä»¶çš„ç±»å‹ï¼ŒtypeAllMaskå½“ç„¶å°±æ˜¯å“åº”æ‰€æœ‰ç±»å‹çš„äº‹ä»¶äº†ã€‚å½“ç„¶è¿˜æœ‰å•å‡»ã€é•¿æŒ‰ã€æ»‘åŠ¨ç­‰ã€‚Â \n          android:accessibilityFeedbackType=\"feedbackSpoken\"\nè®¾ç½®å›é¦ˆç»™ç”¨æˆ·çš„æ–¹å¼\n\n          android:notificationTimeout=\"100\"\n å“åº”æ—¶é—´çš„è®¾ç½®å°±ä¸ç”¨å¤šè¯´äº†Â \n          android:packageNames=\"com.notrace\"\nå¯ä»¥æŒ‡å®šå“åº”æŸä¸ªåº”ç”¨çš„äº‹ä»¶ï¼Œæˆ‘çš„demoåŒ…åå°±å«com.notrace,å¯ä»¥å¤šä¸ªï¼Œç”¨\",\"éš”å¼€ã€‚\n          android:description=\"æ¨¡æ‹Ÿç‚¹å‡»\"\n\næè¿°ä½ åœ¨ç³»ç»Ÿè¾…åŠ©åŠŸèƒ½å¼€å…³ä¸­çœ‹åˆ°çš„æè¿°\n\n3.CheckAccessbilityServices  å®ç°onAccessibilityEventå’ŒonInterruptæ–¹æ³•\n    \n    \n                    @OverrideÂ Â \n                publicÂ voidÂ onAccessibilityEvent(AccessibilityEventÂ event)Â {Â Â \n                          //è¿‡æ»¤åŒ…å\n\t\t\t\t\t\tStringÂ pkgNameÂ =Â event.getPackageName().toString();Â Â \n                          if(!\"com.notrace\".equals(pkgName))\n                                return;\n                        switch (type){  \n                              case AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED:      \n                          //åˆ‡æ¢é¡µé¢çš„æ—¶å€™æ­¤æ—¶ä¼šè§¦å‘ä¸€ä¸ªå«TYPE_WINDOW_STATE_CHANGEDçš„äº‹ä»¶\n                            AccessibilityNodeInfo nodeInfo = getRootInActiveWindow(); \n                           if(nodeInfo!=null)  {\n                               if(\"com.notrace.MainActivity\".equals(event.getClassName())){    \n                                    List<AccessibilityNodeInfo>     list=\n                                    nodeInfo.findAccessibilityNodeInfosByViewId(\"com.notrace:id/btn_click\");\n                              if(list!=null&&list.size()>0)  {        \n                              list.get(0).performAction(AccessibilityNodeInfo.ACTION_CLICK);       \n                               }        \n                          }       \n                           break;   \n                       case AccessibilityEvent.TYPE_WINDOW_CONTENT_CHANGED:   \n                         break;\n                      }Â Â Â Â                  \n               }Â Â \n\n\næ³¨æ„è¿™é‡Œæœ‰ä¸ªå«com.notrace:id/btn_clickçš„ï¼Œå°±æ˜¯å‰é¢çš„é‚£ä¸ªæŒ‰é’®ï¼Œæˆ‘å–idå«btn_click,è¿™ä¸ªä¸œè¥¿å¯ä»¥é€šè¿‡eclipseæä¾›çš„ä¸€ä¸ªå·¥å…·dumpæŸ¥çœ‹,å¦‚ä¸‹å›¾ï¼š\n\n![QQæˆªå›¾20160808162014.png](http://upload-images.jianshu.io/upload_images/1453857-78fa62630f5370b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nå¾®ä¿¡æŠ¢çº¢åŒ…çš„ç•Œé¢ä½ å°±å¯ä»¥è¿™ä¹ˆçœ‹äº†ã€‚\nlist.get(0).performAction(AccessibilityNodeInfo.ACTION_CLICK);      å°±æ˜¯æ¨¡æ‹Ÿç‚¹å‡»äº‹ä»¶\n\n\n\n\nè‡³æ­¤ï¼Œæ¨¡æ‹Ÿç‚¹å‡»å°±å·²ç»å…¨éƒ¨å®Œæˆäº†ï¼Œæˆ‘ä»¬æ‰“å¼€æ‰‹æœºè¾…åŠ©åŠŸèƒ½ç•Œé¢ä¼šçœ‹è§ï¼š\n![QQæˆªå›¾20160808162331.png](http://upload-images.jianshu.io/upload_images/1453857-2b1084259b04dab0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\nç‚¹å‡»è¿›å»ï¼š\n![QQæˆªå›¾20160808162434.png](http://upload-images.jianshu.io/upload_images/1453857-cd8e0447e512c2ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næ‰“å¼€è¿™ä¸ªå¼€å…³å°±å¯ä»¥äº†ã€‚\nè‡³æ­¤ï¼Œå½“é¡µé¢åˆ‡æ¢åˆ°MainActivityä¸­å°±å¯ä»¥å¼¹å‡ºtoastäº†ï¼Œè‡³äºåˆ«çš„å¥‡å¥‡æ€ªæ€ªçš„åŠŸèƒ½ï¼Œå°±éœ€è¦å°ä¼™ä¼´ä»¬è‡ªå·±æ‘¸ç´¢äº†ã€‚\n[Demoä»£ç ](https://github.com/messnoTrace/Demo_Accessbility.git)\n"},{"title":"android room å­˜å‚¨å¤æ‚æ•°æ®ç±»å‹","url":"/2019/04/05/android-room-å­˜å‚¨å¤æ‚æ•°æ®ç±»å‹/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \n\n\n\n\né¦–å…ˆçœ‹æ­¤æ–‡ç« çš„éƒ½å‡è®¾ä½ å·²ç»çœ‹è¿‡äº†roomçš„ç®€å•ç”¨æ³•ï¼Œå¦‚æœæ²¡æœ‰çœ‹è¿‡ï¼Œé‚£ä½ å¯èƒ½éœ€è¦å…ˆå»çœ‹çœ‹äº†ã€‚\nå‡è®¾ï¼Œæˆ‘ä»¬ä»åå°è¿”å›ä¸€ä¸ªæ•°æ®ç±»å‹æ˜¯è¿™æ ·çš„ï¼š    \n\n          public class News{\n            public long id;\n            public String title;\n            public String title;\n            public List<Tag>tags;\n          }\n\n        public class Tag{\n          public long id;\n          public String name;\n      }\n\nè¿™ç§æ•°æ®ç±»å‹å°±æ¯”è¾ƒå¾ˆå¸¸è§äº†ï¼Œå½“ç„¶äº†ï¼Œä½ ç¬¬ä¸€ååº”å¯èƒ½æ˜¯ï¼š è¿™ä¸ªå“ªé‡Œå¤æ‚äº†ï¼Œå—¯ï¼Œè¯´ä¸å¤æ‚ç¡®å®ä¸å¤æ‚ï¼Œè¯´å¤æ‚å‘¢ï¼Œæ˜¯å› ä¸ºç”¨roomçš„è¯ï¼Œç¡®å®æ¯”è¾ƒéº»çƒ¦ï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯å¦‚ä½•ç”¨ roomå­˜å‚¨å¸¦æœ‰lis<Object>ç±»å‹çš„æ•°æ®ã€‚okè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šä»£ç ï¼š\n\n###beançš„æ”¹é€ \n\n          @Entity(tableName = \"news\")\n           public class News{\n          @PrimaryKey(autoGenerate = true)\n            public long id;\n            public String title;\n            public String title;\n           @Ignore\n            public List<Tag>tags;\n          } \n\n\n           @Entity(tableName = \"tags\")\n           public class Tag{\n                 @PrimaryKey(autoGenerate = true)\n                  public long id;\n                  public String name;\n\n                   @ColumnInfo(name = \"news_id\")\n                public long newsid;\n            }\n\n\nç„¶åæˆ‘ä»¬é‡æ–°æ·»åŠ ä¸€ä¸ªbeanï¼šNewsWithTags:\n               \n\n    public class NewsWithTags{\n    @Embedded\n    public News news;\n\n      @Relation(parentColumn = \"id\",entityColumn = \"news_id\")\n       public List<Tag> tags;\n        }\n\n\næ³¨æ„çœ‹è¿™ä¸ªbeanï¼Œæ²¡æœ‰tableæ³¨è§£@Embedded æ³¨è§£çš„æ˜¯newsè¿™ä¸ªbeanã€‚\n@Relation ä¸­parentColumnå¯¹åº”çš„æ˜¯newsä¸­çš„idï¼ŒentityColumnå¯¹åº”çš„æ˜¯tagä¸­çš„news_id,è¿™ä¸ªå€¼å®é™…ä¸Šå°±ç­‰äºnewsä¸­çš„idã€‚\n####Dao\n    NewsWithTagDao:\n\n     @Dao\n    public interface NewsWithTaDao {\n    @Transaction\n    @Query(\"SELECT * FROM news\")\n    List<NewsWithTag> getAllNews();\n\t}\n\n>å…¶ä»–æ²¡å•¥å¥½è¯´çš„ï¼Œæ·»åŠ æ•°æ®è¦å…ˆæ·»åŠ newsï¼Œç„¶åæ ¹æ®news çš„idæ·»åŠ tagï¼Œåˆ é™¤æ•°æ®ï¼Œè¦å…ˆæ ¹æ®newsçš„idåˆ é™¤tagè¡¨ä¸­çš„æ•°æ®\n      \n\n\n"},{"title":"å…³äºUnable to resolve dependency for xxCould not resolve libraryçš„è§£å†³æ–¹æ¡ˆ","url":"/2019/04/05/å…³äºUnable to resolve dependency for xxCould not resolve libraryçš„è§£å†³æ–¹æ¡ˆ/","content":"å…ˆä»‹ç»ä¸‹èƒŒæ™¯ï¼Œç¯å¢ƒæ˜¯Androidstudio3.1.3ï¼Œæ²¡é”™ï¼Œæˆªæ­¢ç›®å‰æ˜¯æœ€æ–°çš„ï¼Œåœ¨ä¸ä¹…ä¹‹å‰ï¼Œæˆ‘ç”¨çš„æ˜¯3.1.2ï¼Œç„¶åæ–°å»ºé¡¹ç›®ï¼Œæ•²ä¸Šä»£ç ï¼Œimplemention å„ç§é¡ºæ‰‹çš„libraryï¼Œæ¯›é—®é¢˜éƒ½æ²¡æœ‰ï¼Œå‡çº§äº†3.1.3ä¹‹åï¼Œæˆ‘æƒ³åŠ ä¸€ä¸ªåº“ï¼Œç»“æœå‡ºç°äº†å¦‚ä¸‹çš„å„ç§é—®é¢˜ã€‚![WX20180626-110232.png](https://upload-images.jianshu.io/upload_images/1453857-4489eca9ee9892f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\nä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯åº“çš„é—®é¢˜ï¼Œç„¶åä¸€é¡¿googleæœç´¢ï¼š\n![WX20180626-110400@2x.png](https://upload-images.jianshu.io/upload_images/1453857-b767224e5beb26ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nçœ¼ç›ä¸€äº®ï¼Œçœ‹åˆ°ç¬¬äºŒä¸ªç­”æ¡ˆç›´æ¥å‡ºç°å…³é”®è¯androidstudio3.0ï¼Œå¿ƒé‡Œé¡¿æ—¶ä¸€é˜µé¸¡å†»ï¼Œç‚¹è¿›å»çœ‹çœ‹ç­”æ¡ˆï¼Œç›´æ¥æ‰¾è®¤åŒæœ€å¤šçš„ç­”æ¡ˆï¼š\n![WX20180626-110636@2x.png](https://upload-images.jianshu.io/upload_images/1453857-2d2ff13fcdfab998.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næ„æ€æ˜¯å•¥å‘¢ï¼Œå¤§æ¦‚å°±æ˜¯è¯´åœ¨andoridsutio2.xå‘3.xè¿ç§»çš„æ—¶å€™éœ€è¦æ³¨æ„ä¿®æ”¹çš„ä¸œè¥¿ï¼Œç„¶å¹¶åµå•Šï¼Œæˆ‘æ˜¯ç›´æ¥ä¸Šçš„3.Xçš„æ–°é¡¹ç›®ï¼Œæ²¡æœ‰è¿ç§»ä¸€è¯´ã€‚éšååˆæ˜¯ä¸€é˜µæœç´¢ï¼Œè¿™ä¸‹å°±å°´å°¬äº†ï¼Œç­”æ¡ˆåŸºæœ¬ä¸Šéƒ½æ˜¯ç±»ä¼¼è¿™æ · çš„å’Œä¸å‹¾é€‰gradle offline workè¿™ä¸ªé€‰é¡¹ï¼Œå„ç§æœç´¢å„ç§çš„è´¼é¸¡å„¿è›‹ç–¼ï¼Œå¹´è½»äººä½ æ„Ÿè§‰å¾—åˆ°ç»æœ›ä¹ˆï¼Œæˆ‘åœ¨æƒ³ï¼Œå¦‚æœæ—¶å…‰å¯ä»¥å€’æµï¼Œæˆ‘è‚¯å®šä¸æ‰‹è´±å‡çº§AndroidStudioï¼Œä»¥å‰çš„2.xç”¨èµ·æ¥ï¼Œæ˜¯æ¯›é—®é¢˜éƒ½æ²¡æœ‰å•Šï¼Œgoogleéƒ½æ•‘ä¸äº†æˆ‘äº†ï¼Œæˆ‘æ€•æ˜¯æ²¡æ•‘äº†ï¼Œç»æœ›ã€‚æ·»åŠ ä¸äº†ä»»ä½•åº“ï¼Œè¿™ä¸ªé—®é¢˜ï¼Œæ˜¯çœŸçš„çœŸçš„å¾ˆè›‹ç–¼å•Šï¼Œå•¥éƒ½è¦è‡ªå·±å†™ï¼Œæ¢ä½ ï¼Œä½ æ„¿æ„ä¹ˆï¼Ÿåæ­£æˆ‘æ˜¯ä¸æ„¿æ„ã€‚ã€‚\næ¥ç€åˆæ˜¯ä¸€æ³¢æ“ä½œçŒ›å¦‚è™ï¼Œä¸­é—´è¿‡ç¨‹å°±ä¸é‡è¦äº†ï¼Œç›´æ¥è·³ç»“æœå§ã€‚\næ‰“å¼€Terminalé€‰é¡¹å¡ï¼Œè¾“å…¥ ./gradlew buildï¼ˆwindowsä¸‹æ˜¯gradlew buildæç¤ºæ²¡è¿™ä¸ªå‘½ä»¤çš„ï¼Œé‚£å°±æ˜¯ä½ çš„gradleç¯å¢ƒå˜é‡æ²¡é…ç½®ï¼‰-> å›è½¦\n\n![WX20180626-111908.png](https://upload-images.jianshu.io/upload_images/1453857-6a68fddb44522e5f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\né‡ç‚¹æ¥äº†ï¼Œ`Connect to 127.0.0.1:1080 [/127.0.0.1] failed: Connection refused (Connection refused)\n` mmp æœç´¢ï¼š\n![WX20180626-112122@2x.png](https://upload-images.jianshu.io/upload_images/1453857-e4706390e41dfdf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nç¬¬ä¸€ä¸ªç‚¹è¿›å» [é“¾æ¥](https://blog.csdn.net/Rainminism/article/details/79713788)\nè¿›å»ä¸€çœ‹è¯´æˆ‘ä»¬ä½¿ç”¨äº†ä»£ç†ï¼Œè¦ä¿®æ”¹gradle.properties æ–‡ä»¶ï¼Œç„¶åé»˜é»˜çš„æ‰“å¼€æˆ‘ä»¬çš„å·¥ç¨‹æ­¤æ–‡ä»¶ä¸€çœ‹ï¼Œ![WX20180626-112620.png](https://upload-images.jianshu.io/upload_images/1453857-23b4e09470d702f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næ„ä¸æ„å¤–ï¼ŒæƒŠä¸æƒŠå–œï¼Œé‡Œé¢æ¯›éƒ½æ²¡æœ‰å•Šï¼Œç„¶åæœ‰æ²¡æœ‰äººè·Ÿæˆ‘ä¸€æ ·ï¼Œæœ‰ç‚¹æ€€ç–‘äººç”Ÿäº†ï¼Œæ€ä¹ˆåŠæ€ä¹ˆåŠï¼Œç»§ç»­æœç´¢å•Šï¼Œæœç„¶ï¼Œåœ¨ä¸€ä¸ªç­”æ¡ˆä¸­å‘ç°äº†è‡ªå·±æ˜¯æœ‰å¤šå‚»é€¼\n![WX20180626-113000@2x.png](https://upload-images.jianshu.io/upload_images/1453857-f646707a7e7906d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\né‡ç‚¹æ¥äº†ï¼Œç¬¬ä¸€å¥ï¼Œ`Go to gradle scripts` ï¼Œå§æ§½ï¼Œæˆ‘æƒ³èµ·æ¥ä¸ªä¸œè¥¿ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨çš„éƒ½æ˜¯projectè§†å›¾å•Šï¼Œæ–°å»ºé¡¹ç›®éƒ½æ˜¯Androidè§†å›¾å•Šï¼Œè¦æ˜¯ä½ æ›¾ç»çœ‹è¿‡Andoridè§†å›¾ï¼Œæˆ–è€…è¯´ä½ æ›¾ç»è§£å†³è¿‡Andoridstudioé‡åˆ°çš„å‘ï¼Œé‚£ä½ å°±æ˜ç™½äº†æˆ‘è¯´çš„æ˜¯å•¥ï¼Œå“å¾—æˆ‘èµ¶ç´§åˆ‡æ¢åˆ°Androidè§†å›¾ï¼š\n![WX20180626-113441.png](https://upload-images.jianshu.io/upload_images/1453857-834fb634600acea8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næœç„¶ï¼Œ`globle properties` \næ‰“å¼€ä¸€çœ‹ï¼Œmmpï¼Œæœç„¶å­˜åœ¨ï¼š![WX20180626-113550.png](https://upload-images.jianshu.io/upload_images/1453857-5b2fc6c929a87506.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\næœæ–­æ³¨é‡Šï¼Œé‡æ–°ç¼–è¯‘ï¼Œè€é“ï¼ŒçœŸçš„æ²¡æ¯›ç—…äº†ã€‚ğŸ˜Œ mmp\n\n\n\n\n\n\n\n"},{"title":"å¤šçº¿ç¨‹ä¸­wait/notifyçš„ä¸€äº›ç†è§£ï¼Œä»¥åŠæœ€ç»å…¸çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…","url":"/2019/04/05/å¤šçº¿ç¨‹ä¸­wait-notifyçš„ä¸€äº›ç†è§£ï¼Œä»¥åŠæœ€ç»å…¸çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…/","content":"\n<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \n\n###å‰è¨€\nè¯´åˆ°waitï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ä¸ªå¸¸é—®çš„é¢è¯•é¢˜ï¼Œwaitå’Œsleepçš„åŒºåˆ«ã€‚ç®€å•çš„ç†è§£å°±æ˜¯ï¼Œwaitæ˜¯objectçš„æ–¹æ³•ï¼Œè°ƒç”¨wait()ï¼Œçº¿ç¨‹ä¼šè¿›å»ç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”ä¼šé‡Šæ”¾å‡ºé”ï¼Œéé˜»å¡çš„ï¼Œç­‰å¾…æŒæœ‰é”çš„çº¿ç¨‹è°ƒç”¨notify()ï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚sleepæ˜¯Threadçš„æ–¹æ³•ï¼Œsleep()ä¼šè®©å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯ä¸ä¼šé‡Šæ”¾é”ï¼Œæ˜¯é˜»å¡çš„ã€‚\n\n###Wait/notifyåœ¨çº¿ç¨‹ä¸­çš„é€šä¿¡\næˆ‘ä»¬å…ˆçœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼š\n class Data:\n\n            package com.notrace;\n            import java.util.ArrayList;\n            import java.util.List;\n            public class Data {\n\t    private List list=new ArrayList();\n\t      public void add() {\n\t\t    list.add(\"notrace\");\n\t    }\n\t      public int getSize() {\n\t\treturn list.size();\n\t    }\n      }\n\n\nThreadAï¼š\n\n      package com.notrace;     \n      public class ThreadA extends Thread{\n\t private Data data;\n\t public ThreadA(Data data) {\n\t\tsuper();\n\t\tthis.data=data;\n\t}\n\t\n\t@Override\n\tpublic void run() {\n\t\ttry {\n\t\t\tfor (int i = 0; i < 10; i++) {\n\t\t\t\tdata.add();\n\t\t\t\tSystem.out.println(\"æ·»åŠ äº†\"+(i+1)+\"ä¸ªå…ƒç´ \");\n\t\t\t\tThread.sleep(1000);\n\t\t\t\t\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t}\n\t}\t\n     }\n\n\nThreadB:\n\n    package com.notrace;\n    public class ThreadB extends Thread{\n\n\tprivate Data data;\n\tpublic ThreadB(Data data) {\n\t\tsuper();\n\t\tthis.data=data;\n\t}\n\t\n\t@Override\n\tpublic void run() {\n\t\ttry {\n\t\t\twhile (true) {\n\t\tSystem.out.print(\"\");\n\t\t\t\tif(data.getSize()==6) {\n\t\t\t\t\tSystem.out.println(\"==6,çº¿ç¨‹Bè¦é€€å‡ºäº†\");\n\t\t\t\t\tthrow new InterruptedException();\n\t\t\t\t}\n\t\t\t}\n\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\t\n    }\n\nTest:\n\n      package com.notrace;\n    public class Test {\n\tpublic static  void  main(String []args) {\n\t\tData data=new Data();\n\t\tThreadA threadA=new ThreadA(data);\n\t\tthreadA.setName(\"A\");\n\t\tthreadA.start();\n\t\tThreadB threadB=new ThreadB(data);\n\t\tthreadB.setName(\"B\");\n\t\tthreadB.start();\n\t}\n    }\n\nè¿è¡Œtestï¼Œç»“æœå¦‚ä¸‹ï¼š![1.png](https://upload-images.jianshu.io/upload_images/1453857-21d6e937cb766da6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å®ç°äº†é€šä¿¡ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œå°±æ˜¯çº¿ç¨‹Bï¼Œè¦ä¸åœçš„å¾ªç¯ï¼Œè¿™æ ·ä¼šå¾ˆæµªè´¹èµ„æºï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„åŠæ³•å»å®ç°å¤šä¸ªçº¿ç¨‹é€šä¿¡å‘¢ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œå°±æ˜¯wait/notifyçš„æœºåˆ¶ã€‚\n\n\n\n###wait/notifyæœºåˆ¶ç®€å•ä»‹ç»\nä¸¾ä¸ªæ —å­ï¼Œå°±è¯´æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„é¤å…å§ï¼Œå¨å¸ˆå’ŒæœåŠ¡å‘˜ä¹‹é—´çš„äº¤äº’ï¼Œ\nå¨å¸ˆåšå®Œèœï¼Œæ”¾åˆ°ä¼ é€’å°ä¸Šï¼ŒæœåŠ¡å‘˜æ¥ä¼ é€’å°ä¸Šå–ï¼Œå¾€æ¡Œä¸Šé€ã€‚\n 1ï¼‰å¨å¸ˆåšå®Œä¸€é“èœçš„æ—¶é—´æ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥æŠŠèœæ”¾åˆ°ä¼ é€’å°ä¸Šçš„æ—¶é—´ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚\n2ï¼‰æœåŠ¡å‘˜å–èœçš„æ—¶é—´ï¼Œå–å†³äºå¨å¸ˆï¼Œæ‰€ä»¥ï¼Œå¨å¸ˆåšå®Œèœä¹‹å‰ï¼ŒæœåŠ¡å‘˜ï¼Œå°±æœ‰äº†ç­‰å¾…(wait)çš„çŠ¶æ€ã€‚\n3ï¼‰æœåŠ¡å‘˜æ˜¯æ€ä¹ˆå–åˆ°èœå‘¢ï¼Ÿè¿™å–å†³äºå¨å¸ˆï¼Œç®€å•ç‚¹æ¥è¯´ï¼Œå¨å¸ˆåšå®Œèœï¼Œæ”¾åˆ°ä¼ é€’å°ä¸Šï¼Œç„¶åå¤§å–Šä¸€å£°ï¼šâ€œçº¢çƒ§è‚‰å¥½äº†ï¼Œæ¥ä¸Šèœã€‚â€ç„¶åæœåŠ¡å‘˜å°±è¿‡æ¥å–äº†ï¼Œè¿™ä¸ªå¤§å–Šä¸€å£°ï¼Œå°±ç›¸å½“äºnotifyçš„è¿‡ç¨‹ã€‚\n4ï¼‰è¿™ä¸ªæƒ…æ™¯ä¸­å°±æœ‰wait/notifyçš„æœºåˆ¶äº†ï¼Œé‚£ä¹ˆå¦‚ä½•ç”¨ä»£ç æ¥å®ç°å‘¢ï¼Ÿ\n####wait/notifyæœºåˆ¶ç®€å•å®ç°\næ–¹æ³•waitï¼ˆï¼‰çš„ä½œç”¨æ˜¯ä½¿å½“å‰æ‰§è¡Œä»£ç çš„çº¿ç¨‹è¿›è¡Œç­‰å¾…ï¼Œwaitï¼ˆï¼‰æ–¹æ³•æ˜¯Objectç±»çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨æ¥å°†å½“å‰çº¿ç¨‹ç½®å…¥â€œé¢„æ‰§è¡Œé˜Ÿåˆ—â€ä¸­ï¼Œå¹¶ä¸”åœ¨waitï¼ˆï¼‰æ‰€åœ¨çš„ä»£ç è¡Œå¤„åœæ­¢æ‰§è¡Œï¼Œç›´åˆ°æ¥åˆ°é€šçŸ¥æˆ–è¢«ä¸­æ–­ä¸ºæ­¢ã€‚åœ¨è°ƒç”¨waitï¼ˆï¼‰ä¹‹å‰ï¼Œ**çº¿ç¨‹å¿…é¡»è·å¾—è¯¥å¯¹è±¡çš„å¯¹è±¡çº§åˆ«é”ï¼Œå³åªèƒ½åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­è°ƒç”¨waitï¼ˆï¼‰æ–¹æ³•ã€‚åœ¨æ‰§è¡Œwaitï¼ˆï¼‰æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹é‡Šæ”¾é”ã€‚** åœ¨ä»waitï¼ˆï¼‰è¿”å›å‰ï¼Œçº¿ç¨‹ä¸å…¶ä»–çº¿ç¨‹ç«äº‰é‡æ–°è·å¾—é”ã€‚å¦‚æœè°ƒç”¨waitï¼ˆï¼‰æ—¶æ²¡æœ‰æŒæœ‰é€‚å½“çš„é”ï¼Œåˆ™æŠ›å‡ºIllegalMonitorStateExceptionï¼Œå®ƒæ˜¯RuntimeExceptionçš„ä¸€ä¸ªå­ç±»ï¼Œå› æ­¤ï¼Œä¸éœ€è¦try-catchè¯­å¥è¿›è¡Œæ•æ‰å¼‚å¸¸ã€‚\n**æ–¹æ³•notifyï¼ˆï¼‰ä¹Ÿè¦åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­è°ƒç”¨ï¼Œå³åœ¨è°ƒç”¨å‰ï¼Œçº¿ç¨‹ä¹Ÿå¿…é¡»è·å¾—è¯¥å¯¹è±¡çš„å¯¹è±¡çº§åˆ«é”ã€‚å¦‚æœè°ƒç”¨notifyï¼ˆï¼‰æ—¶æ²¡æœ‰æŒæœ‰é€‚å½“çš„é”ï¼Œä¹Ÿä¼šæŠ›å‡ºIllegalMonitorStateExceptionã€‚**è¯¥æ–¹æ³•ç”¨æ¥é€šçŸ¥é‚£äº›å¯èƒ½ç­‰å¾…è¯¥å¯¹è±¡çš„å¯¹è±¡é”çš„å…¶ä»–çº¿ç¨‹ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œåˆ™ç”±çº¿ç¨‹è§„åˆ’å™¨éšæœºæŒ‘é€‰å‡ºå…¶ä¸­ä¸€ä¸ªå‘ˆwaitçŠ¶æ€çš„çº¿ç¨‹ï¼Œå¯¹å…¶å‘å‡ºé€šçŸ¥notifyï¼Œå¹¶ä½¿å®ƒç­‰å¾…è·å–è¯¥å¯¹è±¡çš„å¯¹è±¡é”ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨æ‰§è¡Œnotifyï¼ˆï¼‰æ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹ä¸ä¼šé©¬ä¸Šé‡Šæ”¾è¯¥å¯¹è±¡é”ï¼Œå‘ˆwaitçŠ¶æ€çš„çº¿ç¨‹ä¹Ÿå¹¶ä¸èƒ½é©¬ä¸Šè·å–è¯¥å¯¹è±¡é”ï¼Œè¦ç­‰åˆ°æ‰§è¡Œnotifyï¼ˆï¼‰æ–¹æ³•çš„çº¿ç¨‹å°†ç¨‹åºæ‰§è¡Œå®Œï¼Œä¹Ÿå°±æ˜¯é€€å‡ºsynchronizedä»£ç å—åï¼Œå½“å‰çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ï¼Œè€Œå‘ˆwaitçŠ¶æ€æ‰€åœ¨çš„çº¿ç¨‹æ‰å¯ä»¥è·å–è¯¥å¯¹è±¡é”ã€‚å½“ç¬¬ä¸€ä¸ªè·å¾—äº†è¯¥å¯¹è±¡é”çš„waitçº¿ç¨‹è¿è¡Œå®Œæ¯•ä»¥åï¼Œå®ƒä¼šé‡Šæ”¾æ‰è¯¥å¯¹è±¡é”ï¼Œæ­¤æ—¶å¦‚æœè¯¥å¯¹è±¡æ²¡æœ‰å†æ¬¡ä½¿ç”¨notifyè¯­å¥ï¼Œåˆ™å³ä¾¿è¯¥å¯¹è±¡å·²ç»ç©ºé—²ï¼Œå…¶ä»–waitçŠ¶æ€ç­‰å¾…çš„çº¿ç¨‹ç”±äºæ²¡æœ‰å¾—åˆ°è¯¥å¯¹è±¡çš„é€šçŸ¥ï¼Œè¿˜ä¼šç»§ç»­é˜»å¡åœ¨waitçŠ¶æ€ï¼Œç›´åˆ°è¿™ä¸ªå¯¹è±¡å‘å‡ºä¸€ä¸ªnotifyæˆ–notifyAllã€‚\n   ç”¨ä¸€å¥è¯æ¥æ€»ç»“ä¸€ä¸‹waitå’Œnotifyï¼šwaitä½¿çº¿ç¨‹åœæ­¢è¿è¡Œï¼Œè€Œnotifyä½¿åœæ­¢çš„çº¿ç¨‹ç»§ç»­è¿è¡Œã€‚\nä»£ç æµ‹è¯•å¦‚ä¸‹ï¼š\nThreadA:\n        \n          package com.notrace;\n\n    public class ThreadA extends Thread {\n\tprivate Object lock;\n\n\tpublic ThreadA(Object lock) {\n\t\tsuper();\n\t\tthis.lock = lock;\n\t}\n\n\t@Override\n\tpublic void run() {\n\t\ttry {\n\t\t\tsynchronized (lock) {\n\t\t\t\tSystem.out.println(\"begin wait time\" +       System.currentTimeMillis());\n\t\t\t\tlock.wait();\n\t\t\t\tSystem.out.println(\"end wait time\" + System.currentTimeMillis());\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n    }\n\nThreadB:\n\n            package com.notrace;\n\n    public class ThreadB extends Thread {\n\n\tprivate Object lock;\n\n\tpublic ThreadB(Object lock) {\n\t\tsuper();\n\t\tthis.lock = lock;\n\t}\n\n\t@Override\n\tpublic void run() {\n\n\t\ttry {\n\n\t\t\tsynchronized (lock) {\n\t\t\t\tSystem.out.println(\"begin notify time:\" + System.currentTimeMillis());\n\t\t\t\tlock.notify();\n\t\t\t\tSystem.out.println(\"end nofity time:\" + System.currentTimeMillis());\n\t\t\t}\n\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t\tSystem.out.println(e.toString());\n\t\t}\n\t}\n\n    }\n\nTest:\n\n            package com.notrace;\n\npublic class Test {\n\tpublic static void main(String[] args) {\n\n\t\ttry {\n\t\t\tObject lock = new Object();\n\t\t\tThreadA threadA = new ThreadA(lock);\n\t\t\tthreadA.setName(\"A\");\n\t\t\tthreadA.start();\n\n\t\t\tThread.sleep(3000);\n\t\t\tThreadB threadB = new ThreadB(lock);\n\t\t\tthreadB.setName(\"B\");\n\t\t\tthreadB.start();\n\t\t} catch (InterruptedException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n      }\n\nè¿è¡Œç»“æœå¦‚ä¸‹å›¾ï¼š\n  ![2.png](https://upload-images.jianshu.io/upload_images/1453857-070a66f33dd162b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nä»æ‰“å°ç»“æœæ¥çœ‹ï¼Œ3Såçº¿ç¨‹åˆ«nofityå”¤é†’.\næˆ‘ä»¬å†æ¥å®ç°ä¸‹ä¹‹å‰çš„ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼š\nThreadA:\n\n            package com.notrace;\n\n        public class ThreadA extends Thread {\n\tprivate Object lock;\n\n\tpublic ThreadA(Object lock) {\n\t\tsuper();\n\t\tthis.lock = lock;\n\t}\n\n\t@Override\n\tpublic void run() {\n\t    try {\n\t        synchronized (lock) {\n\t        \tif(Data.getSize()!=6)\n\t            System.out.println(\"begin wait time\" +       System.currentTimeMillis());\n\t            lock.wait();\n\t            System.out.println(\"end wait time\" + System.currentTimeMillis());\n\t        }\n\t    } catch (Exception e) {\n\t        e.printStackTrace();\n\t    }\n\t}\n    }\n\n\nThreadB:\n\n            package com.notrace;\n      public class ThreadB extends Thread{\n\n        private Object  lock;\n      public ThreadB(Object lock) {\n        super();\n        this.lock=lock;\n    }\n\n    @Override\n    public void run() {\n        try {\n\n        synchronized (lock) {\n        \tfor (int i = 0; i < 10; i++) {\n\t\t\t\tData.add();\n\t\t\t\tif(Data.getSize()==6) {\n\t\t\t\t\tlock.notify();\n\t\t\t\t\tSystem.out.println(\"å‘å‡ºé€šçŸ¥\");\n\t\t\t\t}\n\t\t\t\tSystem.out.println(\"æ·»åŠ äº†\"+(i+1)+\"ä¸ªå…ƒç´ \");\n\t\t\t\tThread.sleep(1000);\n\t\t\t}        \n          \n        }\n\n    } catch (Exception e) {\n        e.printStackTrace();\n        System.out.println(e.toString());\n    }\n    }\n\n    }\n\n\nData:\n\n            package com.notrace;\n\n      import java.util.ArrayList;\n      import java.util.List;\n\n      public class Data {\n\tprivate static List list = new ArrayList();\n\n\tpublic static void add() {\n\t\tlist.add(\"notrace\");\n\t}\n\n\tpublic static int getSize() {\n\t\treturn list.size();\n\t}\n        }\n\n\nTest:\n\n          package com.notrace;\n\n        public class Test {\n\tpublic static void main(String[] args) {\n\n\t\ttry {\n\t\t\tObject lock = new Object();\n\t\t\tThreadA threadA = new ThreadA(lock);\n\t\t\tthreadA.setName(\"A\");\n\t\t\tthreadA.start();\n\n\t\t\tThread.sleep(50);\n\t\t\tThreadB threadB = new ThreadB(lock);\n\t\t\tthreadB.setName(\"B\");\n\t\t\tthreadB.start();\n\t\t} catch (InterruptedException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n    }\n\nè¿è¡Œç»“æœå¦‚ä¸‹:\n![3.png](https://upload-images.jianshu.io/upload_images/1453857-584bcf34b652abb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næ—¥å¿—è¯´æ˜äº†ä¸€ä¸ªé—®é¢˜,notify()è°ƒç”¨ä¹‹åï¼Œå¹¶ä¸ä¼šç«‹å³é‡Šæ”¾é”ï¼Œè€Œæ˜¯ä¼šæ¥ç€æ‰§è¡Œåé¢çš„ä»£ç ï¼Œæ‰§è¡Œå®Œäº†ï¼Œæ‰ä¼šé‡Šæ”¾é”ã€‚\n\nsynchronizedå¯ä»¥å°†ä»»ä½•ä¸€ä¸ªObjectå¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡æ¥çœ‹å¾…ï¼Œæ¯ä¸ªObjectéƒ½å®ç°äº†wait()å’Œnotify()ã€‚ä»–ä»¬å¿…é¡»ç”¨è¢«ç”¨åœ¨synchronizedåŒæ­¥çš„åŒºåŸŸå†…ï¼Œwait()è®©åŒºåŸŸå†…çš„çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œé‡Šæ”¾åŒæ­¥é”ï¼Œnotify()å¯ä»¥å”¤é†’ä¸€ä¸ªå› è°ƒç”¨äº†wait()è€Œå¤„äºç­‰å¾…çŠ¶æ€ä¸­çš„çº¿ç¨‹ã€‚è¢«å”¤é†’çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œwait()åé¢çš„ä»£ç ã€‚å¦‚æœnotifyä¹‹åæ²¡æœ‰å¤„äºé˜»å¡ç­‰å¾…ä¸­çš„çº¿ç¨‹ï¼Œå°±ä¼šè¢«å¿½ç•¥ã€‚\nå…³äºé‡Šæ”¾é”ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªç»“è®ºï¼Œ\n1ï¼‰æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ï¼Œå°±ä¼šé‡Šæ”¾é”ã€‚\n2ï¼‰æ‰§è¡Œä»£ç å—çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°å¼‚å¸¸è€Œå¯¼è‡´çº¿ç¨‹ç»ˆæ­¢ï¼Œä¹Ÿä¼šé‡Šæ”¾é”ã€‚\n3ï¼‰è°ƒç”¨wait()è¿™ä¸ªçº¿ç¨‹ä¼šé‡Šæ”¾é”ã€‚\n\nå¦å¤–è¿˜æœ‰ä¸€ç‚¹ï¼Œéœ€è¦æä¸€ä¸‹ã€‚notify()åªä¼šå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œå°½é‡ç”¨notifyAll()å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ æ¯”è¾ƒå¥½ã€‚ä¸‹é¢æ¥çœ‹çœ‹å¦ä¸€ä¸ªç»å…¸é—®é¢˜ã€‚\n###ç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å¼\n###ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…\nåºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹code.\nç”Ÿäº§è€…P:\n\n                package com.notrace;\n\n      //ç”Ÿäº§è€…\n      public class P {\n\tprivate String lock;\n\tpublic P(String lock) {\n\t\tsuper();\n\t\tthis.lock=lock;\n\t}\n\tpublic void setValue() {\n\t\ttry {\n\t\t\tsynchronized (lock) {\n\t\t\t\tif(!ValueObj.value.equals(\"\")) {\n\t\t\t\t\tlock.wait();\n\t\t\t\t}\n\t\t\t\tString value=System.currentTimeMillis()+\"\";\n\t\t\t\tSystem.out.println(\"setçš„å€¼ï¼š\"+value);\n\t\t\t\tValueObj.value=value;\n\t\t\t\tlock.notify();\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\t// TODO: handle exception\n\t\t}\n\t}\n    }\n\n\næ¶ˆè´¹è€…C:\n        \n      package com.notrace;\n\n        //æ¶ˆè´¹è€…\n        public class C {\n\tprivate String lock;\n\tpublic C(String lock) {\n\t\tsuper();\n\t\tthis.lock=lock;\n\t}\n\tpublic void getValue() {\n\ttry {\n\t\tsynchronized (lock) {\n\t\t\tif(ValueObj.value.equals(\"\")) {\n\t\t\t\tlock.wait();\n\t\t\t}\n\t\t\tSystem.out.println(\"getçš„å€¼:\"+ValueObj.value);\n\t\t\tValueObj.value=\"\";\n\t\t\tlock.notify();\n\t\t}\n\t} catch (Exception e) {\n\t\t// TODO: handle exception\n\t}\n\t}\n\n    }\n\nçº¿ç¨‹Pï¼š\n\n        package com.notrace;\n\n    public class ThreadP extends Thread{\n\n\tprivate P p;\n\tpublic ThreadP(P p) {\n\t\tsuper();\n\t\tthis.p=p;\n\t}\n\t@Override\n\tpublic void run() {\n\t\twhile(true) {\n\t\t\tp.setValue();\n\t\t}\n\t}\n    }\nçº¿ç¨‹Cï¼š\n\n                package com.notrace;\n\n      public class ThreadC extends Thread{\n\tprivate C c;\n\tpublic ThreadC(C c) {\n\t\tsuper();\n\t\tthis.c=c;\n\t}\n\t@Override\n\tpublic void run() {\n\t\twhile(true) {\n\t\t\tc.getValue();\n\t\t}\n\t}\n    }\n\n\n\nRunï¼š\n\n              package com.notrace;\n\n    public class Run {\n\tpublic static void main(String []args) {\n\t\tString lock=new String(\"\");\n\t\tP p=new P(lock);\n\t\tC c=new C(lock);\n\t\tThreadP tP=new ThreadP(p);\n\t\tThreadC tC=new ThreadC(c);\n\t\ttP.start();\n\t\ttC.start();\n\t}\n\n    }\n\nè¿è¡Œç»“æœï¼š\n![4.png](https://upload-images.jianshu.io/upload_images/1453857-eb6739d745cb9929.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nå¯ä»¥çœ‹å‡ºæ¥ï¼Œæ˜¯ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…ï¼Œäº¤æ›¿è¿è¡Œçš„ã€‚\n\næ¥ä¸‹æ¥å˜åŒ–ä¸€ä¸‹:\n######å¤šç”Ÿäº§è€…ï¼Œå¤šæ¶ˆè´¹è€…\n\nP:\n\n        package com.notrace;\n\n      //ç”Ÿäº§è€…\n      public class P {\n\tprivate String lock;\n\tpublic P(String lock) {\n\t\tsuper();\n\t\tthis.lock=lock;\n\t}\n\tpublic void setValue() {\n\t\ttry {\n\t\t\tsynchronized (lock) {\n\t\t\t\twhile(!ValueObj.value.equals(\"\")) {\n\t\t\t\t\tSystem.out.println(\"ç”Ÿäº§è€…:\"+Thread.currentThread().getName()+\"watting*\");\n\t\t\t\t\tlock.wait();\n\t\t\t\t}\n\t\t\t\tSystem.out.println(\"ç”Ÿäº§è€…:\"+Thread.currentThread().getName()+\"run*\");\n\t\t\t\tString value =System.currentTimeMillis()+\"\";\n\t\t\t\tValueObj.value=value;\n\t\t\t\tlock.notify();\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\t// TODO: handle exception\n\t\t}\n\t}\n    }\n\nC:\n      \n      package com.notrace;\n\n    //æ¶ˆè´¹è€…\n      public class C {\n\tprivate String lock;\n\tpublic C(String lock) {\n\t\tsuper();\n\t\tthis.lock=lock;\n\t}\n\tpublic void getValue() {\n\ttry {\n\t\tsynchronized (lock) {\n\t\t\twhile(ValueObj.value.equals(\"\")) {\n\t\t\t\tSystem.out.println(\"æ¶ˆè´¹è€…:\"+Thread.currentThread().getName()+\"waitting\");\n\t\t\t\tlock.wait();\n\t\t\t}\n\t\t\tSystem.out.println(\"æ¶ˆè´¹è€…:\"+Thread.currentThread().getName()+\"run\");\n\t\t\tSystem.out.println(\"getçš„å€¼:\"+ValueObj.value);\n\t\t\tValueObj.value=\"\";\n\t\t\tlock.notify();\n\t\t}\n\t} catch (Exception e) {\n\t\t// TODO: handle exception\n\t}\n\t}\n\n    }\n\nthreadPï¼ŒthreadCä¸€æ ·:\n\nRun:\n\n            package com.notrace;\n\n      public class Run {\n\tpublic static void main(String []args) {\n\t\ttry {\n\t\t\tString lock=new String(\"\");\n\t\t\tP p=new P(lock);\n\t\t\tC c=new C(lock);\n\t\t\t\n\t\t\tThreadP[] pThreadPs=new ThreadP[2];\n\t\t\tThreadC[]cThreadCs=new ThreadC[2];\n\t\t\tfor(int i=0;i<2;i++) {\n\t\t\t\tpThreadPs[i]=new ThreadP(p);\n\t\t\t\tpThreadPs[i].setName(\"ç”Ÿäº§è€…\"+(i+1));\n\t\t\t\tcThreadCs[i]=new ThreadC(c);\n\t\t\t\tcThreadCs[i].setName(\"æ¶ˆè´¹è€…\"+(i+1));\n\t\t\t\tpThreadPs[i].start();\n\t\t\t\tcThreadCs[i].start();\n\t\t\t}\n\n\t\t\tThread.sleep(5000);\t\n\t\t} catch (Exception e) {\n\t\t\t// TODO: handle exception\n\t\t}\n\t\t\n\t\t\n\t}\n\n      }\n\n\næ‰§è¡Œå®Œï¼š\n![5.png](https://upload-images.jianshu.io/upload_images/1453857-c2d2686d93ecd77d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\nä¸¤ä¸ªéƒ½æ˜¯ç­‰å¾…ï¼Œè€Œä¸”è¿˜æ²¡æ‰§è¡Œå®Œï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªã€‚ã€‚ã€‚äº§ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºå”¤é†’çš„æ—©äº†ç‚¹ï¼Œ ç”Ÿäº§è€…1å”¤é†’äº†ç”Ÿäº§è€…2ï¼Œç„¶è€Œç”Ÿäº§è€…2å‘ç°äº§å“å¹¶æœªè¢«æ¶ˆè´¹ï¼Œæ‰€ä»¥ç”Ÿäº§è€…2ä¹Ÿæ˜¯waitçŠ¶æ€ã€‚å¦å¤–ï¼Œè¿˜æœ‰ç§åŸå› ï¼Œå°±æ˜¯è¿ç»­å”¤é†’åŒç±»ã€‚è§£å†³è¿™ç§é—®é¢˜ï¼Œå°±éœ€è¦å°†På’ŒCä¸­çš„notifyæ”¹æˆnotifyAll()ï¼Œå°†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸€èµ·å”¤é†’ï¼Œå°±okäº†ã€‚\n\n\nå’±æ¥ç€å˜\n######ä¸€ç”Ÿäº§ä¸€æ¶ˆè´¹ï¼šæ¥æ“ä½œæ ˆ\nè¿™ä¸ªåœºæ™¯å°±æ˜¯ç”Ÿäº§è€…å‘å †æ ˆListä¸­æ”¾æ•°æ®ï¼Œæ¶ˆè´¹è€…ä»Listä¸­å–æ•°æ®ã€‚listæœ€å¤§å®¹é‡æ˜¯1:\np:\n\n            package com.notrace;\n\n      //ç”Ÿäº§è€…\n      public class P {\n\t\n\t\n\tprivate MyStack stack;\n\tpublic P(MyStack stack) {\n\t\tsuper();\n\t\tthis.stack=stack;\n\t\t\n\t}\n\tpublic void pushService() {\n\t\tstack.push();\n\t}\n    }\n\n\nC:\n  \n            package com.notrace;\n\n      //æ¶ˆè´¹è€…\n    public class C {\n\t\n\tprivate MyStack stack;\n\tpublic C(MyStack stack) {\n\t\tsuper();\n\t\tthis.stack=stack;\n\t}\n\t\n\tpublic void popService() {\n\t\tSystem.out.println(\"pop=\"+stack.pop());\n\t}\n      }\n\n\nMyStack:\n\n\n            package com.notrace;\n\n      import java.util.ArrayList;\n      import java.util.List;\n\n      public class MyStack {\n      private List list=new ArrayList<>();\n      synchronized public void push() {\n\ttry {\n\t\tif(list.size()==1) {\n\t\t\tthis.wait();\n\t\t}\n\t\tlist.add(\"notrace:\"+Math.random());\n\t\tthis.notify();\n\t\tSystem.out.println(\"push=\"+list.size());\n\t} catch (Exception e) {\n\t\t// TODO: handle exception\n\t}\n      }\n\n          synchronized public String pop() {\n\tString value=\"\";\n\ttry {\n\t\tif(list.size()==0) {\n\t\t\tSystem.out.println(\"popæ“ä½œ\"+Thread.currentThread().getName());\n\t\t\tthis.wait();\n\t\t}\n\t\tvalue=\"\"+list.get(0);\n\t\tlist.remove(0);\n\t\tthis.notify();\n\t\tSystem.out.println(\"pop\"+list.size());\n\t} catch (Exception e) {\n\t\t// TODO: handle exception\n\t}\n\treturn value;\n      }\n    }\n\n\nThreadP:\n\n            package com.notrace;\n\n      public class ThreadP extends Thread{\n\n\tprivate P p;\n\tpublic ThreadP(P p) {\n\t\tsuper();\n\t\tthis.p=p;\n\t}\n\t@Override\n\tpublic void run() {\n\t\twhile(true) {\n\t\t\tSystem.out.print(\"\");\n\t\t\tp.pushService();\n    //\t\t\tp.setValue();\n\t\t\t\n\t\t}\n\t}\n    }\n\n\nThreadC:\n\n            package com.notrace;\n\n    public class ThreadC extends Thread{\n\tprivate C c;\n\tpublic ThreadC(C c) {\n\t\tsuper();\n\t\tthis.c=c;\n\t}\n\t@Override\n\tpublic void run() {\n\t\twhile(true) {\n\t\t\tSystem.out.print(\"\");\n\t\t\tc.popService();\n      //\t\t\tc.getValue();\n\t\t}\n\t}\n      }\n\nRun:\n\n            package com.notrace;\n\npublic class Run {\n\tpublic static void main(String []args) {\n\t\t\n\t\t\n\t\tMyStack stack=new MyStack();\n\t\tP p=new P(stack);\n\t\tC c=new C(stack);\n\t\tThreadP threadP=new ThreadP(p);\n\t\tThreadC threadC=new ThreadC(c);\n\t\tthreadP.start();\n\t\tthreadC.start();\n    }\n    }\n\næ‰§è¡Œç»“æœï¼š\n![6.png](https://upload-images.jianshu.io/upload_images/1453857-eb44c5bbfbef7611.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nç¨‹åºçš„ç»“æœæ˜¯sizeä¸ä¼šå¤§äº1|ã€‚\n\n###ä¸€ç”Ÿäº§å¤šæ¶ˆè´¹ï¼šæ¥æ“ä½œæ ˆ\nä»£ç è¿˜æ˜¯ä¸Šé¢çš„é‚£äº›ï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹Runï¼š\n            \n            package com.notrace;\n\n    public class Run {\n\tpublic static void main(String []args) {\n\t\t\n\t\t\n\t\tMyStack stack=new MyStack();\n\t\tP p=new P(stack);\n\t\tC c1=new C(stack);\n\t\tC c2=new C(stack);\n\t\tC c3=new C(stack);\n\t\tC c4=new C(stack);\n\t\tC c5=new C(stack);\n\t\tThreadP threadP=new ThreadP(p);\n\t\tThreadC threadC1=new ThreadC(c1);\n\t\tThreadC threadC2=new ThreadC(c2);\n\t\tThreadC threadC3=new ThreadC(c3);\n\t\tThreadC threadC4=new ThreadC(c4);\n\t\tThreadC threadC5=new ThreadC(c5);\n\t\tthreadP.start();\n\t\tthreadC1.start();\n\t\tthreadC2.start();\n\t\tthreadC3.start();\n\t\tthreadC4.start();\n\t\tthreadC5.start();\n      }\n      }\næ‰§è¡Œç»“æœï¼š![7.png](https://upload-images.jianshu.io/upload_images/1453857-e4a1b50023c36141.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nå‡æ­»çŠ¶æ€äº†ï¼Œå¤šæ¬¡æ‰§è¡Œã€‚è¿˜å¯èƒ½ä¼šå‡ºç°indexoutofbounceï¼Œè¿™æ˜¯å› ä¸ºæ¡ä»¶æ”¹å˜æ—¶å¹¶æ²¡æœ‰å¾—åˆ°åŠæ—¶çš„å“åº”ï¼Œå¼•èµ·äº†list.remove(0)æŠ¥é”™ï¼Œè§£å†³åŠæ³•æ˜¯å°†MyStackä¸­çš„if()åˆ¤æ–­æ”¹ä¸ºwhile()ã€‚å¤šæ¶ˆè´¹ä¸€ç”Ÿäº§ï¼Œå¤šæ¶ˆè´¹å¤šç”Ÿäº§ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚æ”¹ä¸€ä¸‹runé‡Œé¢çš„ä»£ç å°±è¡Œäº†\n\nå¥½äº†ï¼ŒåŸºæœ¬å®Œäº‹ã€‚\n\n\n\n  \n\n\n\n\n\n  \n\n\n\n                \n\n\n\n"},{"title":"ç”¨androidstudioç¼–å†™ç¬¬ä¸€ä¸ªxposedæ¨¡å—","url":"/2019/04/05/ç”¨androidstudioç¼–å†™ç¬¬ä¸€ä¸ªxposedæ¨¡å—/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \nå‰æï¼šä½ çš„æ‰‹æœºè£…äº†xposedinstaller ï¼Œå·²ç»è·å–rootæƒé™ï¼Œå¦åˆ™ä»¥ä¸‹å†…å®¹ä¸ç”¨çœ‹äº†ã€‚\nå‚è€ƒé“¾æ¥:https://blog.csdn.net/mrglaucusss/article/details/50963542\n\n####é…ç½®å‡†å¤‡å·¥ä½œ\næˆ‘çš„asç‰ˆæœ¬æ˜¯3.1çš„ã€‚æ‰€ä»¥åŸºäºæ­¤ç‰ˆæœ¬åšæ“ä½œ\n* æ–°å»ºä¸€ä¸ªå·¥ç¨‹åŒ…åéšä¾¿å–ã€‚æˆ‘å–äº†com.notrace\n* MainActivityä»£ç ç®€å•å¦‚ä¸‹:\n            \n                package com.notrace;\n          import android.support.v7.app.AppCompatActivity;\n        import android.os.Bundle;\n        import android.view.View;\n        import android.widget.Toast;\n\n        public class MainActivity extends AppCompatActivity {\n\n        @Override\n          protected void onCreate(Bundle savedInstanceState) {\n            super.onCreate(savedInstanceState);\n            setContentView(R.layout.activity_main);\n            findViewById(R.id.buttonPanel).setOnClickListener(new View.OnClickListener() {\n                @Override\n                public void onClick(View v) {\n                Toast.makeText(MainActivity.this,hook(),Toast.LENGTH_SHORT).show();\n                }\n            });\n        }\n    \n        public String hook(){\n        return \"æœªè¢«åŠ«æŒ\";\n        }\n      }\n\nå¾ˆç®€å•ï¼Œä¸€ä¸ªbuttonç‚¹å‡»å¼¹å‡ºtoastï¼Œæ˜¾ç¤ºhookå‡½æ•°è¿”å›å€¼,æˆ‘çš„ç›®æ ‡å°±æ˜¯ä¿®æ”¹è¿™ä¸ªhookçš„è¿”å›å€¼\n\n* ä¿®æ”¹æ¸…å•æ–‡ä»¶ï¼Œåœ¨applicationèŠ‚ç‚¹ä¸‹æ·»åŠ \n\n                      <meta-data\n            android:name=\"xposedmodule\"\n            android:value=\"true\" />\n        <meta-data\n            android:name=\"xposeddescription\"\n            android:value=\"ä½ çŒœçŒœ\" />\n        <meta-data\n            android:name=\"xposedminversion\"\n            android:value=\"54\" />\n\n\nç¬¬ä¸€ä¸ªè¡¨ç¤ºæ˜¯å¦æ˜¯xposedæ¨¡å—\nç¬¬äºŒä¸ªæ˜¯æè¿°ï¼Œéšä¾¿ä½ å†™\nç¬¬ä¸‰ä¸ªæ˜¯æœ€ä½çš„apiç‰ˆæœ¬æ”¯æŒ\n\n* ä¿®æ”¹app/gradle\n\n              repositories {\n            jcenter()\n        }\n        dependencies {\n          compileOnly 'de.robv.android.xposed:api:82'\n          compileOnly 'de.robv.android.xposed:api:82:sources'\n          implementation 'com.android.support:appcompat-v7:27.1.1'\n          implementation 'com.android.support.constraint:constraint-layout:1.1.0'\n          testImplementation 'junit:junit:4.12'\n          androidTestImplementation 'com.android.support.test:runner:1.0.2'\n          androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'\n  \n        }\n\næ³¨æ„ï¼Œä¸Šé¢ä¸¤ä¸ªä¸€å®šè¦ä¿®æ”¹ä¸ºcompileOnly å¦‚æœä½ æ˜¯ä½ç‰ˆæœ¬çš„aså¯ä»¥æ”¹æˆprovided \n\n\n#####ä»£ç \n* æ–°å»ºHookTest ç±»ï¼š\n\n\n              package com.notrace;\n\n            import de.robv.android.xposed.IXposedHookLoadPackage;\n            import de.robv.android.xposed.XC_MethodHook;\n            import de.robv.android.xposed.XposedBridge;\n          import de.robv.android.xposed.XposedHelpers;\n          import de.robv.android.xposed.callbacks.XC_LoadPackage;\n\n          public class HookTest implements IXposedHookLoadPackage {\n              @Override\n              public void handleLoadPackage(XC_LoadPackage.LoadPackageParam loadPackageParam)           throws Throwable {\n\n\n        if(loadPackageParam.packageName.equals(\"com.notrace\")){\n            XposedBridge.log(\"NOTRACE\"+loadPackageParam.packageName);\n\n            Class clazz=loadPackageParam.classLoader.loadClass(\"com.notrace.MainActivity\");\n\n            XposedHelpers.findAndHookMethod(clazz, \"hook\", new XC_MethodHook() {\n                @Override\n                protected void beforeHookedMethod(MethodHookParam param) throws Throwable {\n                    super.beforeHookedMethod(param);\n                }\n\n                @Override\n                protected void afterHookedMethod(MethodHookParam param) throws Throwable {\n                    param.setResult(\"ä½ å·²ç»è¢«åŠ«æŒäº†\");\n                }\n            });\n        }\n    }\n      }\n\n* æ·»åŠ xposedå…¥å£ï¼Œæ–°å»ºassetsï¼š![å¾®ä¿¡æˆªå›¾_20180511182235.png](https://upload-images.jianshu.io/upload_images/1453857-7f9d3d644e31ea0b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nxposed_initå†…å®¹å¦‚ä¸‹ï¼š\n\n          com.notrace.HookTest\n        \n\n* è‡³æ­¤ç»“æŸï¼Œç„¶åå¦‚æœä½ æ²¡æœ‰ç¦ç”¨instant run é‚£ä¹ˆä½ å°±å¾—æ‰“ä¸€ä¸ªå¸¦ç­¾åçš„å®‰è£…åŒ…ï¼Œç„¶åå®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œç„¶åå†xposed installeræ¨¡å—ä¸­å‹¾é€‰ä½ ç¼–å†™çš„moduleï¼Œç„¶åæ‰‹æœºé‡å¯ç”Ÿæ•ˆã€‚\n\n\n\n\n\n\n"},{"title":"Androidå¦‚ä½•åœ¨å­moduleä¸­å–è·å–ä¸»moduleä¸­é€šè¿‡ç½‘ç»œæ¥å£è¯·æ±‚è¿”å›çš„æ•°æ®ï¼Ÿ","url":"/2019/04/05/Androidå¦‚ä½•åœ¨å­moduleä¸­å–è·å–ä¸»moduleä¸­é€šè¿‡ç½‘ç»œæ¥å£è¯·æ±‚è¿”å›çš„æ•°æ®ï¼Ÿ/","content":"<link href=\"http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css\" rel=\"stylesheet\">  \n<script src=\"http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js\"></script>  \n<script >hljs.initHighlightingOnLoad();</script>  \nå¦‚é¢˜ï¼šä»Šå¤©é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨å­moduleä¸­è·å–ä¸»moduleä¸­é€šè¿‡ç½‘ç»œæ¥å£å¼‚æ­¥è¿”å›çš„æ•°æ®ï¼Ÿå—¯ã€‚ã€‚ç»•äº†ä¸€ä¸‹åˆæŠŠè‡ªå·±ç»•è¿›å»äº†ï¼Œç®€å•æ¥è¯´ï¼Œå°±ä¸¤ä¸ªå›è°ƒå®Œäº‹ã€‚ä¸€ä¸ªrequestï¼Œä¸€ä¸ªresponseã€‚ä½†æ˜¯èƒ¡æ€ä¹±æƒ³äº†ä¸€ä¸‹åˆï¼Œå¾ˆæ˜¯å°´å°¬ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œå’±ç›´æ¥ä¸Šä»£ç ã€‚\n###é¦–å…ˆä¸€ä¸ªrequestæ¥å£ï¼š\n            public interface IRequest {\n    public void request(IResponse response);\n      }\n\n###ç„¶åä¸€ä¸ªresponseæ¥å£\n\n            public interface IResponse {\n    void response(String result);\n      }\n\n###ä¸€ä¸ªé€šä¿¡ç®¡ç†\n            public class BridgeManager {\n    private IRequest request;\n\n    public void registerCallback(IRequest request) {\n        this.request = request;\n    }\n\n    public IRequest getRequest() {\n        return request;\n    }\n\n    public void setRequest(IRequest request) {\n        this.request = request;\n    }\n    }\n###ä¸ºäº†æ–¹ä¾¿æ‰©å±•ï¼Œæˆ‘ä»¬å†æ¥ä¸€ä¸ªé€šä¿¡ç®¡ç†çš„listçš„ç®¡ç†å®¹å™¨\n            public class BrigeListManager {\n    private static class SingletonHolder {\n\n        private static final BrigeListManager sInstance = new BrigeListManager();\n    }\n\n    public static BrigeListManager getInstance() {\n        return SingletonHolder.sInstance;\n    }\n\n    private BridgeManager bridgeManager;\n\n    public BridgeManager getBridgeManager() {\n        return bridgeManager;\n    }\n\n    public void setBridgeManager(BridgeManager bridgeManager) {\n        this.bridgeManager = bridgeManager;\n    }\n     }\n\n###   æˆ‘ä»¬å†æ¥å†™ä¸€ä¸ªä¸»å·¥ç¨‹æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„ä¸œä¸œ\n\n          public class MainModuleImpl extends BridgeManager{\n    public MainModuleImpl(){\n\n        registerCallback(new IRequest() {\n            @Override\n            public void request(IResponse response) {\n\n                try {\n                    Thread.sleep(3000);\n\n                    System.out.print(\"è€—æ—¶ä»»åŠ¡æ‰§è¡Œå®Œæ¯•\");\n                    response.response(\"ç»™å­moduleè¿”å›ç»“æœ\");\n                }catch (Exception e){\n\n                }\n            }\n        });\n    }\n       }\n\n\n###  ç„¶åéšä¾¿åœ¨å†™ä¸€ä¸ªä¸»å·¥ç¨‹ä¸­åˆå§‹åŒ–çš„åœ°æ–¹,å…·ä½“æƒ…å†µå…·ä½“è€ƒå¯Ÿï¼Œæˆ‘åªæ¨¡æ‹Ÿä¸€ä¸‹ä¸‹\n            public class MainModule {\n    MainModule(){\n        BrigeListManager.getInstance().setBridgeManager(new MainModuleImpl());\n    }\n     }\n\n\n### å®Œäº‹äº†ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹å­moduleä¸­å¦‚ä½•è·å–\n\n              public class Test {\n    public static void main(String args[]) {\n\n\n        MainModule mainModule=new MainModule();\n        IResponse response = new IResponse() {\n            @Override\n            public void response(String result) {\n                System.out.print(result);\n            }\n        };\n        BrigeListManager.getInstance().getBridgeManager().getRequest().request(response);\n\n    }\n       }\n\n\n###### end\n\n   ![WX20181129-212144@2x.png](https://upload-images.jianshu.io/upload_images/1453857-b084f81966313e54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nå—¯ï¼Œï¼Œï¼Œç¾æ»‹æ»‹å§ï¼Œè™½è¯´ä»£ç ä¸éš¾ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå´è®©æˆ‘æƒ³çš„å¾ˆæ˜¯éš¾å—ï¼Œæ¼ç«ï¼Œå¯èƒ½å¹´çºªå¤§äº†ï¼ŒğŸ˜”\n \n\n\n"},{"title":"èµ„æºç´¢å¼•","url":"/2019/04/05/èµ„æºç´¢å¼•/","content":"### hexo ä½¿ç”¨æ•™ç¨‹\n[hexoæ•™ç¨‹:åŸºæœ¬é…ç½®+æ›´æ¢ä¸»é¢˜+å¤šç»ˆç«¯å·¥ä½œ+coding pageéƒ¨ç½²åˆ†æµ(2)]([http://fangzh.top/2018/2018090715/](http://fangzh.top/2018/2018090715/)\n)\n [æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨Github Pagesæ­å»ºèµ·æˆ‘çš„åšå®¢ï¼Œç»†æ•°ä¸€è·¯çš„å‘](https://www.cnblogs.com/jackyroc/p/7681938.html)\n[hexo-theme-aircloudä¸»é¢˜](https://github.com/aircloud/hexo-theme-aircloud)\n\n\n"}]